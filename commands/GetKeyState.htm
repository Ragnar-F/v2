<!DOCTYPE HTML>
<html>
<head>
<title>GetKeyState</title>
<meta name="description" content="Verwenden Sie GetKeyState in diesem freien Makro-Programm, um auf einfache Weise zu überprüfen, ob eine Taste oben oder unten ist.">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
</head>
<body>

<h1>GetKeyState</h1>

<p>Überprüft, ob eine Taste oben oder unten ist. Kann auch den Joystickstatus abrufen.</p>

<pre class="Syntax">AusgabeVar := <span class="func">GetKeyState</span>(Tastenname <span class="optional">, Modus</span>)</pre>
<h3>Parameter</h3>
<dl>

  <dt>Tastenname</dt>
  <dd><p>Dieser Parameter kann so ziemlich jedes Zeichen von der Tastatur oder ein Tastenname aus der <a href="../KeyList.htm">Tastenliste</a> sein, darunter auch Maus- und Joystick-Tasten. Beispiele: B, 5, LWin, RControl, Alt, Enter, Escape, LButton, MButton, Joy1.</p>
      <p>Alternativ kann ein eindeutiger virtueller Tastencode wie vkFF angegeben werden. Diese Alternative ist in Ausnahmefällen nützlich, wo eine Taste keinen Namen hat. Der virtuelle Tastencode einer solchen Taste kann durch Befolgen der Schritte am unteren Ende der <a href="../KeyList.htm#SpecialKeys">Tastenliste</a> ermittelt werden.</p> 
      <p><b>Bekannte Einschränkung</b>: Diese Funktion kann nicht zwischen zwei Tasten unterscheiden, die den gleichen virtuellen Tastencode haben, wie z. B. Left und NumpadLeft.</p></dd>

  <dt>Modus</dt>
  <dd><p>Dieser Parameter wird beim Abrufen eines Joystick-Status ignoriert.</p>
      <p>Fehlt dieser Parameter, wird standardmäßig der logische Tastenstatus ermittelt. Dieser Status macht dem Betriebssystem und aktivem Fenster glauben, dass die Taste gedrückt wurde, welches aber nicht unbedingt dem physischen Status entspricht.</p>
	  <p>Alternativ kann einer der folgenden Buchstaben angegeben werden:</p>
      <p><strong>P</strong>: Ermittelt den physischen Status (z. B. ob der Benutzer eine Taste physisch gedrückt hält). Der physische Zustand einer Taste oder Maustaste ist üblicherweise das gleiche wie der logische Zustand. Wenn aber Tastatur- und/oder Maus-Hooks installiert sind, gibt der ermittelte Status genau an, ob der Benutzer eine Taste physisch gedrückt hält oder nicht (solange sie nach unten gedrückt wurde, während das Skript lief). Mit der <a href="KeyHistory.htm">KeyHistory</a>-Funktion oder dem dazugehörigen Menüpunkt können Sie überprüfen, ob Ihr Skript die Hooks benutzt. Durch Hinzufügen von <a href="_InstallKeybdHook.htm">#InstallKeybdHook</a> und/oder <a href="_InstallMouseHook.htm">#InstallMouseHook</a> können die Hooks im Skript erzwungen werden.</p>
      <p><strong>T</strong>: Ermittelt den Umschaltstatus (nur für umschaltbare Tasten wie <kbd>Feststell</kbd>, <kbd>Num</kbd>, <kbd>Rollen</kbd> und <kbd>Einfg</kbd> gültig). D bedeutet, dass die Taste "An" ist, und U bedeutet, dass sie "Aus" ist (aber die GetKeyState-Funktion übergibt True (1) für "An" und False (0) für "Aus").</p>
    </dd>

</dl>

<h3>Rückgabewert</h3>
<p>Bei Tastatur- und Maustasten ist der Rückgabewert 1, wenn die Taste unten (oder An) ist, oder 0, wenn sie oben (oder Aus) ist.</p>
<p>Wenn <em>Tastenname</em> ungültig ist oder der Status der Taste nicht ermittelt werden konnte, wird eine leere Zeichenkette zurückgegeben.</p>
<p>Die nächsten 2 Methoden gelten nur für Joysticks:</p>
<p>1) Bei einer Joystick-Achse wie JoyX wird <em>AusgabeVar</em> auf eine Gleitkommazahl zwischen 0 und 100 gesetzt, um die Position des Joysticks als Prozentwert vom Bewegungsbereich der Achse darzustellen. Mit dem <a href="../scripts/JoystickTest.htm">Test-Skript</a> können Sie Ihr(e) Joystick(s) analysieren.</p>
<p>2) Wenn <em>Tastenname</em> JoyPOV ist, wird der abgerufene Wert zwischen 0 und 35900 sein. Die folgenden ungefähren POV-Werte werden von den meisten Joysticks verwendet:<br>
-1: keinen Winkel erkannt<br>
0: nach vorne gerichtet<br>
9000 (90 Grad): nach rechts gerichtet <br>
27000 (270 Grad): nach links gerichtet<br>
18000 (180 Grad): nach hinten gerichtet</p>    

<h3>Bemerkungen</h3>
<p><a href="KeyWait.htm">KeyWait</a> ist kürzer und einfacher als eine GetKeyState-Schleife, wenn es darum geht, auf eine Tastenzustandsänderung zu warten.</p>
<p>Es kann sein, dass Betriebssysteme mit ungewöhnlichen Tastaturtreibern den Zustand ihrer Tasten nur langsam aktualisieren, besonders der Umschaltstatus von Tasten wie <kbd>Feststell</kbd>. Ein Skript, das den Zustand einer solchen Taste überprüft, könnte <a href="Sleep.htm">Sleep</a> davor verwenden, um dem Betriebssystem genug Zeit zum Aktualisieren des Tastenzustands zu verschaffen.</p>
<p>Beispiele zur Verwendung von GetKeyState mit einem Joystick finden Sie in <a href="../misc/RemapJoystick.htm">Joystick-Neubelegung</a> und <a href="../scripts/JoystickMouse.htm">Joystick-Zu-Maus-Skript</a>.</p>
<h3>Siehe auch</h3>
<p><a href="KeyWait.htm">KeyWait</a>, <a href="../KeyList.htm">Tastenliste</a>, <a href="../misc/RemapJoystick.htm">Joystick-Neubelegung</a>, <a href="KeyHistory.htm">KeyHistory</a>, <a href="_InstallKeybdHook.htm">#InstallKeybdHook</a>, <a href="_InstallMouseHook.htm">#InstallMouseHook</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent"><em>; Einfache Beispiele:</em>
Status := GetKeyState("RButton")  <em>; Rechte Maustaste.</em>
Status := GetKeyState("Joy2")  <em>; Die zweite Taste des ersten Joysticks.</em>

if GetKeyState("Shift")
    MsgBox "Mindestens eine UMSCHALT-Taste ist unten."
else
    MsgBox "Keine UMSCHALT-Taste unten."

Status := GetKeyState("CapsLock", "T")  <em>; True, wenn FESTSTELL-Taste AN ist, ansonsten False.</em>

<em>; Neubelegungsbeispiel (dient nur zur Veranschaulichung,
; weil das <a href="../misc/Remap.htm">interne Neubelegungs-Feature</a> leichter zu handhaben wäre):
; Im folgenden Hotkey wird die Maustaste gedrückt gehalten, während NumpadAdd
; unten ist, das NumpadAdd effektiv in eine Maustaste transformiert). Diese Methode
; kann zum Wiederholen einer Aktion benutzt werden, während der Benutzer eine Taste gedrückt hält:</em>
*NumpadAdd::
MouseClick "left",,, 1, 0, "D"  <em>; Hält die linke Maustaste gedrückt.</em>
Loop
{
    Sleep 10
    if !GetKeyState("NumpadAdd", "P")  <em>; Die Taste wurde losgelassen, also Schleife verlassen.</em>
        break
    <em>; ... fügen Sie hier beliebig andere Aktionen ein, die wiederholt werden sollen.</em>
}
MouseClick "left",,, 1, 0, "U"  <em>; Lässt die Maustaste los.</em>
return

<em>; Beispiel: Macht das Verhalten einer Joystick-Taste abhängig von der Achsenposition des Joysticks.</em>
joy2:: 
joyx := GetKeyState("JoyX") 
if joyx &gt; 75 
    MsgBox "Aktion #1 (Taste gedrückt, während Joystick nach rechts bewegt wurde)."
else if joyx &lt; 25 
    MsgBox "Aktion #2 (Taste gedrückt, während Joystick nach links bewegt wurde)."
else
    MsgBox "Aktion #3 (Taste gedrückt, während Joystick horizontal zentriert wurde)."
return

<em>; Siehe <a href="../misc/RemapJoystick.htm">Joystick-Neubelegung</a> und <a href="../scripts/JoystickMouse.htm">Joystick-Zu-Maus-Skript</a> für weitere Beispiele.</em></pre>

</body>
</html>
