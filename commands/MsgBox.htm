<!DOCTYPE HTML>
<html lang="de">
<head>
<title>MsgBox - Syntax &amp; Verwendung | AutoHotkey v2</title>
<meta name="description" content="Die MsgBox-Funktion zeigt einen bestimmten Text in einem kleinen Fenster an, das eine oder mehrere Schaltflächen enthält (z. B. Ja und Nein)." />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
<style>
tr.new_option_group td { border-top-width: 3px; }
</style>
</head>
<body>

<h1>MsgBox</h1>

<p>Zeigt einen bestimmten Text in einem kleinen Fenster an, das eine oder mehrere Schaltflächen enthält (z. B. Ja und Nein).</p>

<pre class="Syntax"><span class="func">MsgBox</span> <span class="optional">Text, Titel, Optionen</span>
Result := <span class="func">MsgBox</span>(<span class="optional">Text, Titel, Optionen</span>)</pre>
<h2>Parameter</h2>
<dl>

  <dt>Text</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Wenn alle Parameter weggelassen werden, zeigt das Mitteilungsfenster "Press OK to continue." an. Ansonsten ist dieser Parameter der Text, der im Mitteilungsfenster angezeigt werden soll, um den Benutzer zu sagen, was zu tun ist, oder um Informationen zu präsentieren.</p>
    <p>Mit <a href="../misc/EscapeChar.htm">Escapesequenzen</a> können spezielle Zeichen dargestellt werden. Zum Beispiel wäre `n ein Zeilenumbruchszeichen, das die aktuelle Zeile beendet und eine neue beginnt. Demzufolge würde Text1`n`nText2 eine leere Zeile zwischen Text1 und Text2 erzeugen.</p>
    <p>Wenn der <em>Text</em>-Parameter relativ lang ist, kann er mithilfe eines <a href="../Scripts.htm#continuation">Fortsetzungsbereichs</a> in mehreren kurzen Zeilen aufgeteilt werden, um ihn übersichtlicher zu machen.</p>
  </dd>

  <dt>Titel</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Der Titel des Mitteilungsfensters. Wenn dieser Parameter fehlt, gilt der aktuelle Wert von <a href="../Variables.htm#ScriptName">A_ScriptName</a>.</p>
  </dd>

  <dt>Optionen</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Kennzeichnet den Typ des Mitteilungsfensters und die möglichen Schaltflächenkombinationen. Fehlt dieser Parameter oder ist er leer, gilt standardmäßig 0. Die zulässigen Werte finden Sie in der folgenden Tabelle.</p>
  </dd>

</dl>

<p>Der <em>Optionen</em>-Parameter akzeptiert entweder einen Integer, der direkt an die MessageBox-Funktion des Betriebssystems übergeben wird, oder eine Zeichenkette mit Null oder mehreren Optionen (nicht-Groß-/Kleinschreibung-sensitiv), die mit mindestens einem Leer- oder Tabulatorzeichen voneinander getrennt werden müssen. Eine oder mehrere numerische Optionen können auch in der Zeichenkette enthalten sein.</p>
<table class="info">
  <tr>
    <th style="width:287px">Funktion</th>
    <th>Dezimal-Wert</th>
    <th>Hex-Wert</th>
    <th>Zeichenkette</th>
  </tr>
  <tr>
    <td>OK</td>
    <td>0</td>
    <td>0x0</td>
    <td><code>OK</code> oder <code>O</code></td>
  </tr>
  <tr>
    <td>OK / Abbrechen</td>
    <td>1</td>
    <td>0x1</td>
    <td><code>OKCancel</code>, <code>O/C</code> oder <code>OC</code></td>
  </tr>
  <tr>
    <td>Abbrechen / Wiederholen / Ignorieren</td>
    <td>2</td>
    <td>0x2</td>
    <td><code>AbortRetryIgnore</code>, <code>A/R/I</code> oder <code>ARI</code></td>
  </tr>
  <tr>
    <td>Ja / Nein / Abbrechen</td>
    <td>3</td>
    <td>0x3</td>
    <td><code>YesNoCancel</code>, <code>Y/N/C</code> oder <code>YNC</code></td>
  </tr>
  <tr>
    <td>Ja / Nein</td>
    <td>4</td>
    <td>0x4</td>
    <td><code>YesNo</code>, <code>Y/N</code> oder <code>YN</code></td>
  </tr>
  <tr>
    <td>Wiederholen / Abbrechen</td>
    <td>5</td>
    <td>0x5</td>
    <td><code>RetryCancel</code>, <code>R/C</code> oder <code>RC</code></td>
  </tr>
  <tr>
    <td>Abbrechen / Wiederholen / Weiter</td>
    <td>6</td>
    <td>0x6</td>
    <td><code>CancelTryAgainContinue</code>, <code>C/T/C</code> oder <code>CTC</code></td>
  </tr>
  <tr>
    <td>Fügt eine Hilfe-Schaltfläche hinzu (siehe Bemerkungen)</td>
    <td>16384</td>
    <td>0x4000</td>
    <td></td>
  </tr>
  <tr><th colspan="4">Symbole</th></tr>
  <tr>
    <td>Handsymbol (Stopp / Fehler)</td>
    <td>16</td>
    <td>0x10</td>
    <td><code>Iconx</code></td>
  </tr>
  <tr>
    <td>Fragezeichensymbol</td>
    <td>32</td>
    <td>0x20</td>
    <td><code>Icon?</code></td>
  </tr>
  <tr>
    <td>Ausrufezeichensymbol</td>
    <td>48</td>
    <td>0x30</td>
    <td><code>Icon!</code></td>
  </tr>
  <tr>
    <td>Sternchensymbol (Info)</td>
    <td>64</td>
    <td>0x40</td>
    <td><code>Iconi</code></td>
  </tr>
  <tr><th colspan="4">Standard-Schaltfläche</th></tr>
  <tr>
    <td>Macht die zweite Schaltfläche zur Standard-Schaltfläche</td>
    <td>256</td>
    <td>0x100</td>
    <td><code>Default2</code></td>
  </tr>
  <tr>
    <td>Macht die dritte Schaltfläche zur Standard-Schaltfläche</td>
    <td>512</td>
    <td>0x200</td>
    <td><code>Default3</code></td>
  </tr>
  <tr>
    <td>Macht die vierte Schaltfläche zur Standard-Schaltfläche<br>(erfordert die Hilfe-Schaltfläche)</td>
    <td>768</td>
    <td>0x300</td>
    <td><code>Default4</code></td>
  </tr>
  <tr><th colspan="4">Modus</th></tr>
  <tr>
    <td>System-Modal (immer im Vordergrund)</td>
    <td>4096</td>
    <td>0x1000</td>
    <td></td>
  </tr>
  <tr>
    <td>Task-Modal</td>
    <td>8192</td>
    <td>0x2000</td>
    <td></td>
  </tr>
  <tr>
    <td>Immer im Vordergrund (WS_EX_TOPMOST-Style)<br>
      (ähnlich wie System Modal, aber ohne Titelleistensymbol)</td>
    <td>262144</td>
    <td>0x40000</td>
    <td></td>
  </tr>
  <tr><th colspan="4"></th></tr>
  <tr>
    <td>Richtet den Text nach rechts aus</td>
    <td>524288</td>
    <td>0x80000</td>
    <td></td>
  </tr>
  <tr>
    <td>Rechts-nach-Links-Leselayout für Hebräisch / Arabisch</td>
    <td>1048576</td>
    <td>0x100000</td>
    <td></td>
  </tr>
  <tr><th colspan="4">Weitere Nur-Zeichenketten-Optionen</th></tr>
  <tr id="OwnerOption">
    <td colspan="3"><p><strong>Owner:</strong> Um ein <a href="#Owner">übergeordnetes Fenster</a> für die MsgBox zu bestimmen, fügt man das Wort <code>Owner</code> gefolgt von einem HWND (Fenster-ID) ein.</p></td>
    <td><code>Owner<i>HWND</i></code></td>
  </tr>
  <tr id="Timeout">
    <td colspan="3"><p><strong>Timeout:</strong> Um die MsgBox automatisch schließen zu lassen, wenn der Benutzer sie nicht innerhalb einer bestimmten Zeit geschlossen hat, fügt man den Buchstaben <code>T</code> ein, gefolgt einem Zeitlimit in Sekunden, das einen Dezimalpunkt enthalten kann. Wenn ein Zeitlimit höher als 2.147.483 (24,8 Tage) angegeben ist, wird es automatisch auf 2.147.483 zurückgesetzt.</p>
    <p>Hat die MsgBox das Zeitlimit überschritten, ist der <a href="#Result">Rückgabewert</a> das Wort <code>Timeout</code>.</p>
    <p>Bekannte Einschränkung: Bei einem Mitteilungsfenster, das nur eine OK-Schaltfläche enthält, kennzeichnet der <a href="#Result">Rückgabewert</a>, dass die OK-Schaltfläche gedrückt wurde, wenn das Mitteilungsfenster das Zeitlimit überschreitet, während ihr eigener <a href="../misc/Threads.htm">Thread</a> von einem anderen Thread unterbrochen wird.</p></td>
    <td></td>
  </tr>
</table>

<h2 id="Result">Rückgabewert</h2>
<p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
<p>Wenn MsgBox mit der Ausdruckssyntax aufgerufen wird, gibt sie eine der folgenden Zeichenketten zurück, die anzeigen, welche Schaltfläche der Benutzer gedrückt hat:</p>
<p>OK<br>

Cancel<br>

Yes<br>

No<br>

Abort<br>

Retry<br>

Ignore<br>

TryAgain<br>

Continue<br>
Timeout (also wenn die MsgBox das Zeitlimit überschritten hat)</p>

<h2>Bemerkungen</h2>
<p>Ein typisches Mitteilungsfenster sieht wie folgt aus:</p>
<img src="../static/dlg_message.png" alt="MsgBox" />
<p>Der <a href="#Result">Rückgabewert</a> der Funktion kann genutzt werden, um festzustellen, welche Schaltfläche der Benutzer gedrückt hat. Zum Beispiel:</p>
<pre>Result := MsgBox("Möchten Sie fortfahren? (drücken Sie Ja oder Nein)",, "YesNo")
if Result = "Yes"
    MsgBox "Sie haben Ja gedrückt."
else
    MsgBox "Sie haben Nein gedrückt."

if MsgBox("Wiederholen oder Abbrechen?",, "R/C") = "Retry"
    MsgBox("Sie haben Wiederholen gedrückt.")</pre>
<p>Um die Namen der Schaltflächen individuell anzupassen, ist <a href="../scripts/MsgBoxButtonNames.htm">dieses Beispiel</a> hilfreich.</p>
<p><strong>Tipp</strong>: Sie können <kbd>Strg</kbd>+<kbd>C</kbd> in einem aktiven Mitteilungsfenster drücken, um dessen Text in die Zwischenablage zu kopieren. Diese Methode kann auch bei Mitteilungsfenstern angewendet werden, die nicht mit AutoHotkey erstellt wurden.</p>
<p id="Owner"><strong>MsgBox mit einem GUI-Fenster verwenden</strong>: Ein GUI-Fenster kann ein <em>modales</em> Mitteilungsfenster mithilfe der <a href="../objects/Gui.htm#OwnDialogs">OwnDialogs-Option</a> darstellen. Ein <em>modales</em> Mitteilungsfenster bewirkt, dass der Benutzer erst wieder mit dem GUI-Fenster interagieren kann, wenn er Mitteilungsfenster schließt. In so einem Fall können die Optionen System-Modal oder Task-Modal weggelassen werden.</p>
<p>Wenn die <a href="../objects/Gui.htm#OwnDialogs">OwnDialogs-Option</a> <em>nicht</em> aktiv ist, kann die Task-Modal-Option (8192) genutzt werden, um die Interaktion mit allen Skriptfenstern zu deaktivieren, bis der Benutzer das Mitteilungsfenster schließt.</p>
<p>Wenn die <code>Owner<i>HWND</i></code>-Option angegeben ist, hat sie Vorrang vor allen anderen Einstellungen. <i>HWND</i> kann das HWND eines beliebigen Fensters sein, auch eines, das nicht zum Skript gehört.</p>
<p><strong>Die Hilfe-Schaltfläche</strong>: Um die Hilfe-Schaltfläche im Mitteilungsfenster zu aktivieren, gibt man den Wert 16384 im <em>Optionen</em>-Parameter an. Allerdings wird diese Schaltfläche erst funktionieren, wenn folgende Bedingungen zutreffen:</p>
<ol>
  <li>Das Mitteilungsfenster wurde einem GUI-Fenster mithilfe der <a href="../objects/Gui.htm#OwnDialogs">OwnDialogs-Option</a> untergeordnet.</li>
  <li>Das Skript überwacht die WM_HELP-Meldung (0x53). Zum Beispiel: <code><a href="OnMessage.htm">OnMessage</a>(0x53, "WM_HELP")</code>. Diese Anweisung bewirkt, dass, sobald der Benutzer die Hilfe-Schaltfläche drückt, die WM_HELP-Funktion aufgerufen wird. Diese Funktion könnte zum Beispiel ein anderes GUI-Fenster oder Mitteilungsfenster anzeigen, um den Benutzer Instruktionen mitzuteilen.</li>
</ol>
<p><strong>Die Schließen-Schaltfläche (in der Titelleiste des Mitteilungsfensters)</strong>: Aufgrund der Tatsache, dass das Mitteilungsfenster intern vom Betriebssystem kontrolliert wird, sind die Verfügbarkeit und das Verhalten der <strong>X</strong>-Schaltfläche abhängig davon, welche Schaltflächen vorhanden sind. Wenn nur die OK-Schaltfläche vorhanden ist, wäre das Drücken von <strong>X</strong> das gleiche wie, als hätte man OK gedrückt. Ansonsten ist die X-Schaltfläche deaktiviert, es sei denn, die Abbrechen-Schaltfläche ist vorhanden - in diesem Fall wäre das Drücken von <strong>X</strong> das gleiche wie, als hätte man Abbrechen gedrückt.</p>
<h2>Siehe auch</h2>
<p><a href="InputBox.htm">InputBox</a>, <a href="FileSelect.htm">FileSelect</a>, <a href="DirSelect.htm">DirSelect</a>, <a href="ToolTip.htm">ToolTip</a>, <a href="../objects/Gui.htm">Gui-Objekt</a></p>
<h2>Beispiel</h2>
<pre class="NoIndent">MsgBox  <em>; "Press OK to continue."</em>

MsgBox "Das ist eine Zeichenkette."

MsgBox "Diese MsgBox hat einen benutzerdefinierten Titel.", "Ein benutzerdefinierter Titel"

MsgBox "  <em>; Benutzen Sie einen <a href="../Scripts.htm#continuation">Fortsetzungsbereich</a>, um mehrere Zeilen übersichtlich darzustellen:</em>
  (
    Der erste Parameter wird als Nachricht angezeigt.
    Der zweite Parameter ist der Fenstertitel.
    Der dritte Parameter bestimmt den Typ des Mitteilungsfensters.
  )", "Fenstertitel", "iconi"

if MsgBox("Möchten Sie fortfahren? (Drücken Sie JA oder NEIN)",, "YesNo") = "No"
    return
	
result := MsgBox("Diese MsgBox wird innerhalb von 5 Sekunden automatisch geschlossen.  Weiter?",, "Y/N T5")
if result = "Timeout"
    MsgBox "Sie haben innerhalb der 5 Sekunden weder JA noch NEIN gedrückt."
else if result = "No"
    return

<em>; Fügen Sie eine Variable oder Teilausdruck in die Mitteilung ein.</em>
var := 10
MsgBox "Der Initialwert ist: " var
MsgBox "Das Ergebnis ist: " var * 2  <em>; <a href="../Variables.htm#concat">Verkettung</a>.</em>
MsgBox <a href="Format.htm">Format</a>("Das Ergebnis ist: {1}", var * 2)</pre>
</body>
</html>
