<!DOCTYPE HTML>
<html lang="de">
<head>
<title>MsgBox - Syntax &amp; Verwendung | AutoHotkey v2</title>
<meta name="description" content="Die MsgBox-Funktion zeigt einen bestimmten Text in einem kleinen Fenster an, das eine oder mehrere Schaltflächen enthält (z. B. Ja und Nein)." />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
<style type="text/css">
  .fopt {
    width: 4em;
    text-align: center
  }

  .fnum {
    width: 4em;
    text-align: right
  }
</style>
</head>
<body>

<h1>MsgBox</h1>

<p>Zeigt einen bestimmten Text in einem kleinen Fenster an, das eine oder mehrere Schaltflächen enthält (z. B. Ja und Nein).</p>

<pre class="Syntax"><span class="func">MsgBox</span> <span class="optional">Text, Titel, Optionen</span>
Result := <span class="func">MsgBox</span>(<span class="optional">Text, Titel, Optionen</span>)</pre>
<h2>Parameter</h2>
<dl>

  <dt>Text</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Lässt man alle Parameter weg, zeigt das Mitteilungsfenster "Press OK to continue." an. Ansonsten ist dieser Parameter der Text, der im Mitteilungsfenster angezeigt werden soll, um den Benutzer zu sagen, was zu tun ist, oder um Informationen zu präsentieren.</p>
    <p>Mit <a href="../misc/EscapeChar.htm">Escapesequenzen</a> können spezielle Zeichen dargestellt werden. Zum Beispiel wäre `n ein Zeilenumbruchszeichen, das die aktuelle Zeile beendet und eine neue beginnt. Demzufolge würde Text1`n`nText2 eine leere Zeile zwischen Text1 und Text2 erzeugen.</p>
    <p>Wenn der <em>Text</em>-Parameter relativ lang ist, kann er mithilfe eines <a href="../Scripts.htm#continuation">Fortsetzungsbereichs</a> in mehreren kurzen Zeilen aufgeteilt werden, um ihn übersichtlicher zu machen.</p>
  </dd>

  <dt>Titel</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Der Titel des Mitteilungsfensters. Lässt man diesen Parameter weg, wird standardmäßig der aktuelle Wert von <a href="../Variables.htm#ScriptName">A_ScriptName</a> verwendet.</p>
  </dd>

  <dt>Optionen</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Kennzeichnet den Typ des Mitteilungsfensters und die möglichen Schaltflächenkombinationen. Wenn dieser Parameter weggelassen wird oder leer ist, wird standardmäßig 0 verwendet. Die zulässigen Werte finden Sie in den folgenden Tabellen.</p>
  </dd>

</dl>

<h2>Werte für den <em>Optionen</em>-Parameter</h2>
<p>Der <em>Optionen</em>-Parameter kann entweder eine Kombination (Summe) von Werten aus den folgenden Gruppen sein, die direkt an die MessageBox-Funktion des Betriebssystems übergeben wird, oder eine Zeichenkette mit Null oder mehreren Optionen (nicht-Groß-/Kleinschreibung-sensitiv) sein, die mit mindestens einem Leer- oder Tabulatorzeichen voneinander getrennt werden müssen. Eine oder mehrere numerische Optionen können auch in der Zeichenkette enthalten sein.</p>

<h3>Gruppe #1: Schaltflächen</h3>
<p>Um zu bestimmen, welche Schaltflächen im Mitteilungsfenster angezeigt werden sollen, addiert man <strong>einen</strong> der folgenden Werte:</p>
<table class="info">
  <tr>
    <th>Zeichenkette</th>
    <th>Dez</th>
    <th>Hex</th>
    <th style="text-align:left">Beschreibung</th>
  </tr>
  <tr>
    <td class="fopt">O</td>
    <td class="fnum">0</td>
    <td class="fnum">0x0</td>
    <td>Zeigt nur die Schaltfläche OK an. Statt O können Sie auch OK nutzen.</td>
  </tr>
  <tr>
    <td class="fopt">OC</td>
    <td class="fnum">1</td>
    <td class="fnum">0x1</td>
    <td>Zeigt die Schaltflächen OK und Abbrechen an. Statt OC können Sie auch O/C oder OKCancel nutzen.</td>
  </tr>
  <tr>
    <td class="fopt">ARI</td>
    <td class="fnum">2</td>
    <td class="fnum">0x2</td>
    <td>Zeigt die Schaltflächen Abbrechen, Wiederholen und Ignorieren an. Statt ARI können Sie auch A/R/I oder AbortRetryIgnore nutzen.</td>
  </tr>
  <tr>
    <td class="fopt">YNC</td>
    <td class="fnum">3</td>
    <td class="fnum">0x3</td>
    <td>Zeigt die Schaltflächen Ja, Nein und Abbrechen an. Statt YNC können Sie auch Y/N/C oder YesNoCancel nutzen.</td>
  </tr>
  <tr>
    <td class="fopt">YN</td>
    <td class="fnum">4</td>
    <td class="fnum">0x4</td>
    <td>Zeigt die Schaltflächen Ja und Nein an. Statt YN können Sie auch Y/N oder YesNo nutzen.</td>
  </tr>
  <tr>
    <td class="fopt">RC</td>
    <td class="fnum">5</td>
    <td class="fnum">0x5</td>
    <td>Zeigt die Schaltflächen Wiederholen und Abbrechen an. Statt RC können Sie auch R/C oder RetryCancel nutzen.</td>
  </tr>
  <tr>
    <td class="fopt">CTC</td>
    <td class="fnum">6</td>
    <td class="fnum">0x6</td>
    <td>Zeigt die Schaltflächen Abbrechen, Wiederholen und Weiter an. Statt CTC können Sie auch C/T/C oder CancelTryAgainContinue nutzen.</td>
  </tr>
</table>

<h3>Gruppe #2: Icon</h3>
<p>Um ein Symbol im Mitteilungsfenster darzustellen, addiert man <strong>einen</strong> der folgenden Werte:</p>
<table class="info">
  <tr>
    <th>Zeichenkette</th>
    <th>Dez</th>
    <th>Hex</th>
    <th style="text-align:left">Beschreibung</th>
  </tr>
  <tr>
    <td class="fopt">Iconx</td>
    <td class="fnum">16</td>
    <td class="fnum">0x10</td>
    <td>Zeigt ein Handsymbol an, das üblicherweise Stopp oder Fehler signalisiert.</td>
  </tr>
  <tr>
    <td class="fopt">Icon?</td>
    <td class="fnum">32</td>
    <td class="fnum">0x20</td>
    <td>Zeigt ein Fragezeichensymbol an.</td>
  </tr>
  <tr>
    <td class="fopt">Icon!</td>
    <td class="fnum">48</td>
    <td class="fnum">0x30</td>
    <td>Zeigt ein Ausrufezeichensymbol an.</td>
  </tr>
  <tr>
    <td class="fopt">Iconi</td>
    <td class="fnum">64</td>
    <td class="fnum">0x40</td>
    <td>Zeigt ein Sternchensymbol an, das üblicherweise eine Information signalisiert.</td>
  </tr>
</table>

<h3>Gruppe #3: Standard-Schaltfläche</h3>
<p>Um die Standard-Schaltfläche zu bestimmen, addiert man <strong>einen</strong> der folgenden Werte:</p>
<table class="info">
  <tr>
    <th>Zeichenkette</th>
    <th>Dez</th>
    <th>Hex</th>
    <th style="text-align:left">Beschreibung</th>
  </tr>
  <tr>
    <td class="fopt">Default2</td>
    <td class="fnum">256</td>
    <td class="fnum">0x100</td>
    <td>Macht die zweite Schaltfläche zur Standardschaltfläche.</td>
  </tr>
  <tr>
    <td class="fopt">Default3</td>
    <td class="fnum">512</td>
    <td class="fnum">0x200</td>
    <td>Macht die dritte Schaltfläche zur Standardschaltfläche.</td>
  </tr>
  <tr>
    <td class="fopt">Default4</td>
    <td class="fnum">768</td>
    <td class="fnum">0x300</td>
    <td>Macht die vierte Schaltfläche zur Standardschaltfläche. Die <a href="#Help">Hilfe-Schaltfläche</a> muss dafür vorhanden sein.</td>
  </tr>
</table>

<h3>Gruppe #4: Modalität</h3>
<p>Um die Modalität des Dialogfensters zu bestimmen, addiert man <strong>einen</strong> der folgenden Werte:</p>
<table class="info">
  <tr>
    <th>Zeichenkette</th>
    <th>Dez</th>
    <th>Hex</th>
    <th style="text-align:left">Beschreibung</th>
  </tr>
  <tr>
    <td class="fopt">&nbsp;</td>
    <td class="fnum">4096</td>
    <td class="fnum">0x1000</td>
    <td>System-Modal (immer im Vordergrund)</td>
  </tr>
  <tr>
    <td class="fopt">&nbsp;</td>
    <td class="fnum">8192</td>
    <td class="fnum">0x2000</td>
    <td>Task-Modal</td>
  </tr>
  <tr>
    <td class="fopt">&nbsp;</td>
    <td class="fnum">262144</td>
    <td class="fnum">0x40000</td>
    <td>Immer-im-Vordergrund (WS_EX_TOPMOST-Style) (ähnlich wie System-Modal, aber ohne Titelleistensymbol)</td>
  </tr>
</table>

<h3>Gruppe #5: Sonstige Optionen</h3>
<p>Um sonstige Optionen anzugeben, addiert man <strong>einen oder mehrere</strong> der folgenden Werte:</p>
<table class="info">
  <tr>
    <th>Zeichenkette</th>
    <th>Dez</th>
    <th>Hex</th>
    <th style="text-align:left">Beschreibung</th>
  </tr>
  <tr id="Help">
    <td class="fopt">&nbsp;</td>
    <td class="fnum">16384</td>
    <td class="fnum">0x4000</td>
    <td>
      <p>Fügt eine Hilfe-Schaltfläche hinzu. Das Drücken dieser Schaltfläche wird erst funktionieren, wenn folgende Bedingungen zutreffen:</p>
      <ol>
        <li>Das Mitteilungsfenster wurde einem GUI-Fenster mithilfe der <a href="../objects/Gui.htm#OwnDialogs">OwnDialogs-Option</a> untergeordnet.</li>
        <li>Das Skript überwacht die WM_HELP-Meldung (0x53). Zum Beispiel: <code><a href="OnMessage.htm">OnMessage</a>(0x53, "WM_HELP")</code>. Diese Anweisung bewirkt, dass, sobald der Benutzer die Hilfe-Schaltfläche drückt, die WM_HELP-Funktion aufgerufen wird. Diese Funktion könnte zum Beispiel ein anderes GUI-Fenster oder Mitteilungsfenster anzeigen, um den Benutzer Instruktionen mitzuteilen.</li>
      </ol>
    </td>
  </tr>
  <tr>
    <td class="fopt">&nbsp;</td>
    <td class="fnum">524288</td>
    <td class="fnum">0x80000</td>
    <td>Macht den Text rechtsbündig.</td>
  </tr>
  <tr>
    <td class="fopt">&nbsp;</td>
    <td class="fnum">1048576</td>
    <td class="fnum">0x100000</td>
    <td>Aktiviert das Rechts-nach-Links-Leselayout für Hebräisch/Arabisch.</td>
  </tr>
    <tr id="OwnerOption">
      <td class="fopt">Owner<em>HWND</em></td>
      <td class="fnum">&nbsp;</td>
      <td class="fnum">&nbsp;</td>
      <td>Um ein <a href="#Owner">übergeordnetes Fenster</a> für die MsgBox zu bestimmen, fügen Sie das Wort <code>Owner</code> gefolgt von einem Fenster-Handle (HWND) ein.</td>
    </tr>
  <tr id="Timeout">
    <td class="fopt">T<em>Sekunden</em></td>
    <td class="fnum">&nbsp;</td>
    <td class="fnum">&nbsp;</td>
    <td>
      <p>(Timeout) Um die MsgBox automatisch schließen zu lassen, wenn der Benutzer sie nicht innerhalb einer bestimmten Zeit geschlossen hat, fügt man den Buchstaben <code>T</code> ein, gefolgt einem Zeitlimit in Sekunden, das einen Dezimalpunkt enthalten kann. Wenn ein Zeitlimit höher als 2147483 (24,8 Tage) angegeben ist, wird es automatisch auf 2147483 zurückgesetzt.</p>
      <p>Hat die MsgBox das Zeitlimit überschritten, ist der <a href="#Result">Rückgabewert</a> das Wort <code>Timeout</code>.</p>
    </td>
  </tr>
</table>

<h2 id="Result">Rückgabewert</h2>
<p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
<p>Wenn MsgBox mit der Ausdruckssyntax aufgerufen wird, gibt sie eine der folgenden Zeichenketten zurück, die anzeigen, welche Schaltfläche der Benutzer gedrückt hat:</p>
<p>OK<br>

Cancel<br>

Yes<br>

No<br>

Abort<br>

Retry<br>

Ignore<br>

TryAgain<br>

Continue<br>
Timeout (also wenn die MsgBox das Zeitlimit überschritten hat)</p>

<h2>Bemerkungen</h2>
<p>Ein typisches Mitteilungsfenster sieht wie folgt aus:</p>
<img src="../static/dlg_message.png" alt="MsgBox" />
<p>Der <a href="#Result">Rückgabewert</a> der Funktion kann genutzt werden, um festzustellen, welche Schaltfläche der Benutzer gedrückt hat. Zum Beispiel:</p>
<pre>Result := MsgBox("Möchten Sie fortfahren? (drücken Sie Ja oder Nein)",, "YesNo")
if Result = "Yes"
    MsgBox "Sie haben Ja gedrückt."
else
    MsgBox "Sie haben Nein gedrückt."

if MsgBox("Wiederholen oder Abbrechen?",, "R/C") = "Retry"
    MsgBox("Sie haben Wiederholen gedrückt.")</pre>
<p>Um die Namen der Schaltflächen individuell anzupassen, ist <a href="../scripts/MsgBoxButtonNames.htm">dieses Beispiel</a> hilfreich.</p>
<p><strong>Tipp</strong>: Sie können <kbd>Strg</kbd>+<kbd>C</kbd> in einem aktiven Mitteilungsfenster drücken, um dessen Text in die Zwischenablage zu kopieren. Diese Methode kann auch bei Mitteilungsfenstern angewendet werden, die nicht mit AutoHotkey erstellt wurden.</p>
<p id="Owner"><strong>MsgBox mit einem GUI-Fenster verwenden</strong>: Ein GUI-Fenster kann ein <em>modales</em> Mitteilungsfenster mithilfe der <a href="../objects/Gui.htm#OwnDialogs">OwnDialogs-Option</a> darstellen. Ein <em>modales</em> Mitteilungsfenster hindert den Benutzer daran, mit dem GUI-Fenster zu interagieren, bis er das Mitteilungsfenster wieder schließt. In so einem Fall können die Optionen System-Modal oder Task-Modal weggelassen werden.</p>
<p>Wenn die <a href="../objects/Gui.htm#OwnDialogs">OwnDialogs-Option</a> <em>nicht</em> aktiv ist, kann die Task-Modal-Option (8192) genutzt werden, um die Interaktion mit allen Skriptfenstern zu deaktivieren, bis der Benutzer das Mitteilungsfenster schließt.</p>
<p>Wenn die <code>Owner<i>HWND</i></code>-Option angegeben ist, hat sie Vorrang vor allen anderen Einstellungen. <i>HWND</i> kann das HWND eines beliebigen Fensters sein, auch eines, das nicht zum Skript gehört.</p>
<p><strong>Die Schließen-Schaltfläche (in der Titelleiste des Mitteilungsfensters)</strong>: Aufgrund der Tatsache, dass das Mitteilungsfenster intern vom Betriebssystem kontrolliert wird, sind die Verfügbarkeit und das Verhalten der <strong>X</strong>-Schaltfläche abhängig davon, welche Schaltflächen vorhanden sind. Wenn nur die OK-Schaltfläche vorhanden ist, wäre das Drücken von <strong>X</strong> das gleiche wie, als hätte man OK gedrückt. Ansonsten ist die X-Schaltfläche deaktiviert, es sei denn, die Abbrechen-Schaltfläche ist vorhanden - in diesem Fall wäre das Drücken von <strong>X</strong> das gleiche wie, als hätte man Abbrechen gedrückt.</p>
<h2>Siehe auch</h2>
<p><a href="InputBox.htm">InputBox</a>, <a href="FileSelect.htm">FileSelect</a>, <a href="DirSelect.htm">DirSelect</a>, <a href="ToolTip.htm">ToolTip</a>, <a href="../objects/Gui.htm">Gui-Objekt</a></p>
<h2>Beispiele</h2>
<div class="ex" id="ExBasic">
<p><a href="#ExBasic">#1</a></p>
<pre>
MsgBox  <em>; "Press OK to continue."</em>

MsgBox "Das ist eine Zeichenkette."

MsgBox "Diese MsgBox hat einen benutzerdefinierten Titel.", "Ein benutzerdefinierter Titel"
</pre>
</div>

<div class="ex" id="ExContSec">
<p><a href="#ExContSec">#2</a>: Benutzen Sie einen <a href="../Scripts.htm#continuation">Fortsetzungsbereich</a>, um mehrere Zeilen übersichtlich darzustellen:</p>
<pre>
MsgBox "
  (
    Der erste Parameter wird als Nachricht angezeigt.
    Der zweite Parameter ist der Fenstertitel.
    Der dritte Parameter bestimmt den Typ des Mitteilungsfensters.
  )", "Fenstertitel", "iconi"
</pre>
</div>

<div class="ex" id="ExRetValue">
<p><a href="#ExRetValue">#3</a>: Führen Sie je nach Rückgabewert unterschiedliche Aktionen durch:</p>
<pre>
if MsgBox("Möchten Sie fortfahren? (Drücken Sie JA oder NEIN)",, "YesNo") = "No"
    return
	
result := MsgBox("Diese MsgBox wird innerhalb von 5 Sekunden automatisch geschlossen.  Weiter?",, "Y/N T5")
if result = "Timeout"
    MsgBox "Sie haben innerhalb der 5 Sekunden weder JA noch NEIN gedrückt."
else if result = "No"
    return
</pre>
</div>

<div class="ex" id="ExExpr">
<p><a href="#ExExpr">#4</a>: Fügen Sie eine Variable oder Teilausdruck in die Mitteilung ein:</p>
<pre>
var := 10
MsgBox "Der Initialwert ist: " var
MsgBox "Das Ergebnis ist: " var * 2  <em>; <a href="../Variables.htm#concat">Verkettung</a>.</em>
MsgBox <a href="Format.htm">Format</a>("Das Ergebnis ist: {1}", var * 2)
</pre>
</div>
</body>
</html>
