<!DOCTYPE HTML>
<html lang="de">
<head>
<title>MsgBox - Syntax &amp; Verwendung | AutoHotkey v2</title>
<meta name="description" content="Die MsgBox-Funktion zeigt einen bestimmten Text in einem kleinen Fenster an, das einen oder mehrere Buttons enthält (z. B. Ja und Nein)." />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
<style>
tr.new_option_group td { border-top-width: 3px; }
</style>
</head>
<body>

<h1>MsgBox</h1>

<p>Zeigt einen bestimmten Text in einem kleinen Fenster an, das einen oder mehrere Buttons enthält (z. B. Ja und Nein).</p>

<pre class="Syntax"><span class="func">MsgBox</span> <span class="optional">Text, Titel, Optionen</span>
Result := <span class="func">MsgBox</span>(<span class="optional">Text, Titel, Optionen</span>)</pre>
<h2>Parameter</h2>
<dl>

  <dt>Text</dt>
  <dd><p>Fehlen alle Parameter, wird die Message Box "Press OK to continue." anzeigen. Ansonsten ist dieser Parameter ein Text, der innerhalb des Message Box angezeigt werden soll, um den Benutzer zu sagen, was zu tun ist, oder um Informationen zu präsentieren.</p>
    <p>Mit <a href="../misc/EscapeChar.htm">Escapesequenzen</a> können spezielle Zeichen dargestellt werden. Zum Beispiel wäre `n ein Zeilenumbruchszeichen, das die aktuelle Zeile beendet und eine neue beginnt. Demzufolge würde Text1`n`nText2 eine leere Zeile zwischen Text1 und Text2 erzeugen.</p>
    <p>Wenn der <em>Text</em> zu lang ist, kann er in mehreren kurzen Zeilen aufgeteilt werden (<a href="../Scripts.htm#continuation">Fortsetzungsbereich</a>), um ihn besser lesbar und verwaltbar zu machen.</p></dd>

  <dt>Titel</dt>
  <dd><p>Der Titel der Message Box. Wenn dieser Parameter fehlt, gilt der aktuelle Wert von <a href="../Variables.htm#ScriptName">A_ScriptName</a>.</p></dd>

  <dt>Optionen</dt>
  <dd><p>Bestimmt den Typ der Message Box und die möglichen Button-Kombinationen. Fehlt dieser Parameter oder ist er leer, gilt standardmäßig 0. Siehe untere Tabelle, welche Werte zulässig sind.</p></dd>

</dl>

<p>Der <em>Optionen</em>-Parameter akzeptiert entweder einen Integerwert, der direkt an die MessageBox-Funktion des Betriebssystems übergeben wird, oder eine Zeichenkette mit null oder mehreren Optionen, deren Groß-/Kleinschreibung egal ist und mit mindestens einem Leer- oder Tabulatorzeichen voneinander getrennt sind. Eine oder mehrere numerische Optionen können auch in der Zeichenkette enthalten sein.</p>
<table class="info">
  <tr>
    <th style="width:287px">Funktion</th>
    <th>Dezimal-Wert</th>
    <th>Hex-Wert</th>
    <th>Zeichenkette</th>
  </tr>
  <tr>
    <td>OK (also wo nur ein OK-Button angezeigt wird)</td>
    <td>0</td>
    <td>0x0</td>
    <td><code>OK</code> oder <code>O</code></td>
  </tr>
  <tr>
    <td>OK/Abbrechen</td>
    <td>1</td>
    <td>0x1</td>
    <td><code>OKCancel</code>, <code>O/C</code> oder <code>OC</code></td>
  </tr>
  <tr>
    <td>Abbrechen / Wiederholen / Ignorieren</td>
    <td>2</td>
    <td>0x2</td>
    <td><code>AbortRetryIgnore</code>, <code>A/R/I</code> oder <code>ARI</code></td>
  </tr>
  <tr>
    <td>Ja / Nein / Abbrechen</td>
    <td>3</td>
    <td>0x3</td>
    <td><code>YesNoCancel</code>, <code>Y/N/C</code> oder <code>YNC</code></td>
  </tr>
  <tr>
    <td>Ja / Nein</td>
    <td>4</td>
    <td>0x4</td>
    <td><code>YesNo</code>, <code>Y/N</code> oder <code>YN</code></td>
  </tr>
  <tr>
    <td>Wiederholen / Abbrechen</td>
    <td>5</td>
    <td>0x5</td>
    <td><code>RetryCancel</code>, <code>R/C</code> oder <code>RC</code></td>
  </tr>
  <tr>
    <td>Abbrechen / Wiederholen / Weiter</td>
    <td>6</td>
    <td>0x6</td>
    <td><code>CancelTryAgainContinue</code>, <code>C/T/C</code> oder <code>CTC</code></td>
  </tr>
  <tr>
    <td>Fügt ein Hilfe-Button hinzu (siehe Bemerkungen)</td>
    <td>16384</td>
    <td>0x4000</td>
    <td></td>
  </tr>
  <tr><th colspan="4">Symbole</th></tr>
  <tr>
    <td>Handsymbol (Stopp / Fehler)</td>
    <td>16</td>
    <td>0x10</td>
    <td><code>Iconx</code></td>
  </tr>
  <tr>
    <td>Fragezeichensymbol</td>
    <td>32</td>
    <td>0x20</td>
    <td><code>Icon?</code></td>
  </tr>
  <tr>
    <td>Ausrufezeichensymbol</td>
    <td>48</td>
    <td>0x30</td>
    <td><code>Icon!</code></td>
  </tr>
  <tr>
    <td>Sternchensymbol (Info)</td>
    <td>64</td>
    <td>0x40</td>
    <td><code>Iconi</code></td>
  </tr>
  <tr><th colspan="4">Standard-Button</th></tr>
  <tr>
    <td>Macht den zweiten Button zum Standard-Button</td>
    <td>256</td>
    <td>0x100</td>
    <td><code>Default2</code></td>
  </tr>
  <tr>
    <td>Macht den dritten Button zum Standard-Button</td>
    <td>512</td>
    <td>0x200</td>
    <td><code>Default3</code></td>
  </tr>
  <tr>
    <td>Macht den vierten Button zum Standard-Button<br>(Hilfe-Button muss vorhanden sein)</td>
    <td>768</td>
    <td>0x300</td>
    <td><code>Default4</code></td>
  </tr>
  <tr><th colspan="4">Modus</th></tr>
  <tr>
    <td>System Modal (immer im Vordergrund)</td>
    <td>4096</td>
    <td>0x1000</td>
    <td></td>
  </tr>
  <tr>
    <td>Task Modal</td>
    <td>8192</td>
    <td>0x2000</td>
    <td></td>
  </tr>
  <tr>
    <td>Immer im Vordergrund (WS_EX_TOPMOST-Style)<br>
      (Wie System Modal, aber ohne Symbol in der Titelleiste)</td>
    <td>262144</td>
    <td>0x40000</td>
    <td></td>
  </tr>
  <tr><th colspan="4"></th></tr>
  <tr>
    <td>Richtet den Text nach rechts aus</td>
    <td>524288</td>
    <td>0x80000</td>
    <td></td>
  </tr>
  <tr>
    <td>Rechts-nach-Links-Leselayout für Hebräisch / Arabisch</td>
    <td>1048576</td>
    <td>0x100000</td>
    <td></td>
  </tr>
  <tr><th colspan="4">Weitere Nur-Zeichenketten-Optionen</th></tr>
  <tr id="OwnerOption">
    <td colspan="3"><p><strong>Owner:</strong> Um ein <a href="#Owner">übergeordnetes Fenster</a> für die MsgBox zu bestimmen, fügt man das Wort <code>Owner</code> gefolgt von einem HWND (Fenster-ID) ein.</p></td>
    <td><code>Owner<i>HWND</i></code></td>
  </tr>
  <tr id="Timeout">
    <td colspan="3"><p><strong>Timeout:</strong> Um die MsgBox automatisch schließen zu lassen, wenn der Benutzer sie nicht innerhalb einer bestimmten Zeit geschlossen hat, fügt man den Buchstaben <code>T</code> ein, gefolgt einem Zeitlimit in Sekunden, das ein Dezimaltrennzeichen enthalten kann. Überschreitet dieser Wert 2.147.483 (24,8 Tage), wird er automatisch auf 2.147.483 zurückgesetzt.</p>
    <p>Hat die MsgBox das Zeitlimit überschritten, ist der <a href="#Result">Rückgabewert</a> das Wort <code>Timeout</code>.</p>
    <p>Bekannte Einschränkung: Enthält die Message Box nur einen OK-Button, wird der <a href="#Result">Rückgabewert</a> kennzeichnen, dass der OK-Button gedrückt wurde, wenn die Message Box das Zeitlimit überschritten hat, während ihr eigener <a href="../misc/Threads.htm">Thread</a> von einem anderen Thread unterbrochen wird.</p></td>
    <td></td>
  </tr>
</table>

<h2 id="Result">Rückgabewert</h2>
<p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
<p>Wenn MsgBox mit der Ausdruckssyntax aufgerufen wird, gibt sie eine der folgenden Zeichenketten zurück, die anzeigen, welche Schaltfläche der Benutzer gedrückt hat:</p>
<p>OK<br>

Cancel<br>

Yes<br>

No<br>

Abort<br>

Retry<br>

Ignore<br>

TryAgain<br>

Continue<br>
Timeout (also wenn die MsgBox das Zeitlimit überschritten hat)</p>

<h2>Bemerkungen</h2>
<p>Der <a href="#Result">Rückgabewert</a> der Funktion kann genutzt werden, um festzustellen, welchen Button der Benutzer gedrückt hat. Zum Beispiel:</p>
<pre>Result := MsgBox("Möchten Sie fortfahren? (drücken Sie Ja oder Nein)",, "YesNo")
if Result = "Yes"
    MsgBox "Sie haben Ja gedrückt."
else
    MsgBox "Sie haben Nein gedrückt."

if MsgBox("Wiederholen oder Abbrechen?",, "R/C") = "Retry"
    MsgBox("Sie haben Wiederholen gedrückt.")</pre>
<p>Die Namen der Buttons können mit <a href="../scripts/MsgBoxButtonNames.htm">diesem Beispiel</a> geändert werden.</p>
<p><strong>Tipp</strong>: Drückt man <kbd>Strg</kbd>+<kbd>C</kbd>, während die Message Box aktiv ist, wird ihr Text in die Zwischenablage kopiert. Diese Möglichkeit kann bei allen Message Boxes angewendet werden, nicht nur bei solchen, die mit AutoHotkey erstellt worden sind.</p>
<p id="Owner"><strong>MsgBox mit einem GUI-Fenster verwenden</strong>: Ein GUI-Fenster kann eine <em>modale</em> Message Box mithilfe der <a href="../objects/Gui.htm#OwnDialogs">OwnDialogs-Option</a> darstellen. Solange ein <em>modales</em> Dialogfenster offen ist, kann der Benutzer nicht mit dem GUI-Fenster interagieren. In so einem Fall ist es nicht notwendig, die System-Modal- oder Task-Modal-Option aus der oberen Tabelle anzugeben.</p>
<p>Wenn die <a href="../objects/Gui.htm#OwnDialogs">OwnDialogs-Option</a> <em>nicht</em> aktiv ist, kann mit der Task-Modal-Option (8192) jedes Skriptfenster deaktiviert werden, solange die Message Box offen ist.</p>
<p>Wenn die <code>Owner<i>HWND</i></code>-Option angegeben ist, hat sie Vorrang vor allen anderen Einstellungen. <i>HWND</i> kann das HWND eines beliebigen Fensters sein, sogar solche, die nicht vom Skript erstellt wurden.</p>
<p><strong>Der Hilfe-Button</strong>: Sofern die Hilfe-Button-Option (16384) in den <em>Optionen</em> angegeben ist, wird der Hilfe-Button erst eine Wirkung haben, wenn die beiden folgenden Bedingungen erfüllt sind:</p>
<ol>
  <li>Die Message Box wurde einem GUI-Fenster mithilfe der <a href="../objects/Gui.htm#OwnDialogs">OwnDialogs-Option</a> untergeordnet.</li>
  <li>Das Skript überwacht die WM_HELP-Meldung (0x53). Zum Beispiel: <code><a href="OnMessage.htm">OnMessage</a>(0x53, "WM_HELP")</code>. Durch Aufrufen der WM_HELP-Funktion könnte man den Benutzer zusätzliche Hinweise mithilfe eines weiteren Fensters oder Message Box geben.</li>
</ol>
<p><strong>Der Schließen-Button (in der Titelleiste der MsgBox)</strong>: Da die Message Box ein system-internes Feature ist, wird ihr <strong>X</strong>-Button nur aktiv sein, wenn bestimmte Buttons vorhanden sind. Gibt es nur einen OK-Button, wäre das Anklicken von <strong>X</strong> das gleiche wie, als würde man OK drücken. Gibt es einen Abbrechen-Button, wäre das Anklicken von <strong>X</strong> das gleiche wie, als würde man Abbrechen drücken. Ansonsten ist der X-Button deaktiviert.</p>
<h2>Siehe auch</h2>
<p><a href="InputBox.htm">InputBox</a>, <a href="FileSelect.htm">FileSelect</a>, <a href="DirSelect.htm">DirSelect</a>, <a href="ToolTip.htm">ToolTip</a>, <a href="../objects/Gui.htm">Gui-Objekt</a></p>
<h2>Beispiel</h2>
<pre class="NoIndent">MsgBox  <em>; "Press OK to continue."</em>

MsgBox "Das ist eine Zeichenkette."

MsgBox "Diese MsgBox hat einen benutzerdefinierten Titel.", "Ein benutzerdefinierter Titel"

MsgBox "  <em>; Benutzen Sie einen <a href="../Scripts.htm#continuation">Fortsetzungsbereich</a>, um mehrere Zeilen aufzuteilen:</em>
  (
    Der erste Parameter wird als Nachricht angezeigt.
    Der zweite Parameter ist der Fenstertitel.
    Der dritte Parameter bestimmt den Typ der MsgBox.
  )", "Fenstertitel", "iconi"

if MsgBox("Möchten Sie fortfahren? (Drücken Sie JA oder NEIN)",, "YesNo") = "No"
    return
	
result := MsgBox("Diese MsgBox wird in 5 Sekunden automatisch geschlossen.  Weiter?",, "Y/N T5")
if result = "Timeout"
    MsgBox "Sie haben innerhalb der 5 Sekunden weder auf JA noch auf NEIN gedrückt."
else if result = "No"
    return

<em>; Fügen Sie eine Variable oder Nebenausdruck in die Nachricht ein.</em>
var := 10
MsgBox "Der Initialwert ist: " var
MsgBox "Das Ergebnis ist: " var * 2  <em>; <a href="../Variables.htm#concat">Verkettung</a>.</em>
MsgBox <a href="Format.htm">Format</a>("Das Ergebnis ist: {1}", var * 2)</pre>
</body>
</html>
