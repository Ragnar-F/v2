<!DOCTYPE HTML>
<html>
<head>
<title>DriveGet</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
</head>
<body>

<h1>DriveGet</h1>

<p>Funktionen zum Abrufen diverser Informationen über die Laufwerke des Computers.</p>

<h3 id="List">DriveGetList</h3>
<p>Gibt eine Zeichenkette mit Buchstaben zurück, die die Laufwerksbuchstaben des Systems repräsentieren. Zum Beispiel: ACDEZ.</p>
<pre class="Syntax">Laufwerke := <span class="func">DriveGetList</span>(<span class="optional">Typ</span>)</pre>
<dl>
  <dt>Typ</dt>
  <dd><p>Fehlt der <em>Typ</em>-Parameter, werden alle Typen abgerufen. Ansonsten kann bei <em>Typ</em> eines der folgenden Wörter angegeben werden, um nur einen bestimmten Laufwerkstypen abzurufen: CDROM, REMOVABLE, FIXED, NETWORK, RAMDISK, UNKNOWN.</p></dd>
</dl>

<h3 id="Capacity">DriveGetCapacity</h3>
<p>Ermittelt die Gesamtkapazität von <em>Pfad</em> (z. B. C:\) in Megabyte.</p>
<pre class="Syntax">MB := <span class="func">DriveGetCapacity</span>(Pfad)</pre>
<dl>
  <dt>Pfad</dt>
  <dd><p>Ein beliebiger Pfad, der zum Laufwerk gehört.</p></dd>
</dl>

<h3 id="SpaceFree">DriveGetSpaceFree</h3>
<p>Ermittelt den freien Speicherplatz des Laufwerks, das den <em>Pfad</em> enthält, in MB (auf das nächste Megabyte abgerundet).</p>
<pre class="Syntax">MB := <span class="func">DriveGetSpaceFree</span>(Pfad)</pre>
<dl>
  <dt>Pfad</dt>
  <dd><p>Ein beliebiger Pfad, der zum Laufwerk gehört.</p></dd>
</dl>

<h3 id="Filesystem">DriveGetFilesystem</h3>
<p>Ermittelt den Typ des Dateisystems von <em>Laufwerk</em>.</p>
<pre class="Syntax">FS := <span class="func">DriveGetFilesystem</span>(Laufwerk)</pre>
<dl>
  <dt>Laufwerk</dt>
  <dd><p>Der Laufwerksbuchstabe, gefolgt von einem Doppelpunkt und einem umgekehrten Schrägstrich, oder ein Netzwerkpfad im UNC-Format wie <code>\\server1\share1</code>.</p></dd>
</dl>
<p>Der Rückgabewert ist eines der folgenden Wörter: FAT, FAT32, NTFS, CDFS (typisch für CDs), UDF (typisch für DVDs). Wenn das Laufwerk kein formatiertes Medium enthält, wird der Rückgabewert leer gemacht und <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 1 gesetzt.</p>

<h3 id="Label">DriveGetLabel</h3>
<p>Ermittelt die Datenträgerbezeichnung von <em>Laufwerk</em>.</p>
<pre class="Syntax">Bezeichnung := <span class="func">DriveGetLabel</span>(Laufwerk)</pre>
<dl>
  <dt>Laufwerk</dt>
  <dd><p>Der Laufwerksbuchstabe, gefolgt von einem Doppelpunkt und einem umgekehrten Schrägstrich, oder ein Netzwerkpfad im UNC-Format wie <code>\\server1\share1</code>.</p></dd>
</dl>
<p>Die Bezeichnung kann wie folgt geändert werden: <code><a href="Drive.htm#SetLabel">DriveSetLabel</a>("C:", "MeineBezeichnung")</code>.</p>

<h3 id="Serial">DriveGetSerial</h3>
<p>Ermittelt die Datenträgerseriennummer von <em>Laufwerk</em> als dezimalen Integer.</p>
<pre class="Syntax">Nummer := <span class="func">DriveGetSerial</span>(Laufwerk)</pre>
<dl>
  <dt>Laufwerk</dt>
  <dd><p>Der Laufwerksbuchstabe, gefolgt von einem Doppelpunkt und einem umgekehrten Schrägstrich, oder ein Netzwerkpfad im UNC-Format wie <code>\\server1\share1</code>.</p></dd>
</dl>

<h3 id="Type">DriveGetType</h3>
<p>Ermittelt den Laufwerkstypen von <em>Pfad</em>, der eines der folgenden Wörter sein wird: Unknown, Removable, Fixed, Network, CDROM, RAMDisk.</p>
<pre class="Syntax">Typ := <span class="func">DriveGetType</span>(Pfad)</pre>
<dl>
  <dt>Pfad</dt>
  <dd><p>Ein beliebiger Pfad, der zum Laufwerk gehört.</p></dd>
</dl>

<h3 id="Status">DriveGetStatus</h3>
<p>Ermittelt den Status von <em>Pfad</em>.</p>
<pre class="Syntax">Status := <span class="func">DriveGetStatus</span>(Pfad)</pre>
<dl>
  <dt>Pfad</dt>
  <dd><p>Ein beliebiger Pfad, der zum Laufwerk gehört.</p></dd>
</dl>
<p>Der Rückgabewert ist eine der folgenden Zeichenketten:</p>
<table class="info">
  <tr><th>Zeichenkette</th><th>Hinweise</th></tr>
  <tr><td>Unknown</td><td>Könnte auf ein unformatiertes/RAW-Dateisystem hinweisen.</td></tr>
  <tr><td>Ready</td><td>Kommt am häufigsten vor.</td></tr>
  <tr><td>NotReady</td><td>Typisch für Wechseldatenträger, die kein Medium enthalten.</td></tr>
  <tr><td>Invalid</td><td><em>Pfad</em> existiert nicht oder ist ein Netzlaufwerk, auf das gerade nicht zugegriffen werden kann, usw.</td></tr>
</table>

<h3 id="StatusCD">DriveGetStatusCD</h3>
<p>Ermittelt den Mediumstatus eines CD- oder DVD-Laufwerks.</p>
<pre class="Syntax">Status := <span class="func">DriveGetStatusCD</span>(<span class="optional">Laufwerk</span>)</pre>
<dl>
  <dt>Laufwerk</dt>
  <dd><p>Der Laufwerksbuchstabe, gefolgt von einem Doppelpunkt. Fehlt dieser Parameter, gilt das Standard-CD/DVD-Laufwerk.</p></dd>
</dl>
<p>Der Rückgabewert wird leer gemacht, wenn der Status nicht ermittelt werden kann. Ansonsten wird er eine der folgenden Zeichenketten sein:</p>
<table class="info">
  <tr>
    <td style="width:15%">not ready</td>
    <td>Das Laufwerk ist gerade nicht zugreifbar, weil es vermutlich an einer Schreiboperation beteiligt ist. Bekannte Einschränkung: "not ready" tritt auch auf, wenn das Laufwerk eine DVD statt CD enthält.</td>
  </tr>
  <tr>
    <td>open</td>
    <td>Das Laufwerk enthält keine Disc, oder ist offen.</td>
  </tr>
  <tr>
    <td>playing</td>
    <td>Das Laufwerk spielt gerade eine Disc ab.</td>
  </tr>
  <tr>
    <td>paused</td>
    <td>Das zuvor abgespielte Audio oder Video ist nun pausiert.</td>
  </tr>
  <tr>
    <td>seeking</td>
    <td>Das Laufwerk ist am Suchen.</td>
  </tr>
  <tr>
    <td>stopped</td>
    <td>Das Laufwerk enthält eine CD, aber greift auf sie gerade nicht zu.</td>
  </tr>
</table>
<p>Wahrscheinlich wird diese Funktion nicht funktionieren, wenn sie auf ein Netzwerk- oder Nicht-CD/DVD-Laufwerk zugreifen soll; hat die Funktion in solchen oder sonstigen Fällen kein Erfolg, wird der Rückgabewert leer gemacht und <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 1 gesetzt.</p>
<p>Wenn das Laufwerk gerade geschlossen wurde, kann es zu einer Verzögerung kommen, bevor die Funktion endet.</p>
<p>Mit <a href="Drive.htm#Eject">DriveEject</a> kann ein Laufwerk ein- oder ausgefahren werden.</p>

<h3>ErrorLevel</h3>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird bei Misserfolg auf 1 und bei Erfolg auf 0 gesetzt.</p>

<h3>Bemerkungen</h3>
<p>Einige dieser Funktionen akzeptieren als <em>Pfad</em> oder <em>Laufwerk</em> auch Netzwerkfreigabenamen wie <code>\\MeinServer\MeinFreigabe\</code></p>
<p>In der Regel kann <em>Pfad</em> (aber nicht <em>Laufwerk</em>) ein beliebiger Pfad sein. Da NTFS bereitgestellte Volumes (mounted volumes) und Verzeichnisverbindungen (directory junctions) unterstützt, können unterschiedliche Pfade mit demselben Laufwerk unterschiedliche Ergebnisse erzeugen (unterschiedliche Mengen an freiem Speicher, Kapazität, etc.).</p>

<h3>Siehe auch</h3>
<p><a href="Drive.htm">Drive</a></p>

<h3>Beispiel</h3>
<pre class="NoIndent"><em>; Das ist ein funktionierendes Beispiel-Skript.</em>
Ordner := DirSelect( , 3, "Laufwerk zum Überprüfen auswählen:")
if Ordner = ""
    return
Liste := DriveGetList()
Max := DriveGetCapacity(Ordner)
Frei := DriveGetSpaceFree(Ordner)
DS := DriveGetFilesystem(Ordner)
Name := DriveGetLabel(Ordner)
Nummer := DriveGetSerial(Ordner)
Typ := DriveGetType(Ordner)
Status := DriveGetStatus(Ordner)
MsgBox("
(Q
  Alle Laufwerke: " Liste "
  Ausgewähltes Laufwerk: " Ordner "
  Typ: " Typ "
  Status: " Status "
  Kapazität: " Max " MB
  Freier Speicher: " Frei " MB
  Dateisystem: " DS "
  Bezeichnung: " Name "
  Seriennummer: " Nummer
))</pre>

</body>
</html>
