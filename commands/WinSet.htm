<!DOCTYPE HTML>
<html>
<head>
<title>WinSet</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
</head>
<body>

<h1>WinSet</h1>

<p>Funktionen für verschiedene Fensteroperationen, wie z. B. "immer im Vordergrund" und Transparenz.</p>

<h3 id="AlwaysOnTop">WinSetAlwaysOnTop</h3>
<p>Ändert ein Fenster, so dass es immer über allen anderen Fenstern (außer andere Immer-Im-Vordergrund-Fenster) liegt.</p>
<pre class="Syntax"><span class="func">WinSetAlwaysOnTop</span> <span class="optional">Wert, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<dl>
  <dt>Wert</dt>
  <dd><p>Einer der folgenden case-insensitiven Text- oder Zahlwerten:</p><p>
    <code>ON</code> oder <code>1</code> (<a href="Variables.htm#True">true</a>) aktiviert die Einstellung.<br>
    <code>OFF</code> oder <code>0</code> (<a href="../Variables.htm#False">false</a>) deaktiviert die Einstellung.<br>
    <code>TOGGLE</code> oder <code>-1</code> setzt die Einstellung auf den entgegengesetzten Zustand.
  </p>
  <p>Fehlt dieser Parameter, gilt standardmäßig <code>TOGGLE</code>.</p></dd>
</dl>
<p>Mit <a href="WinGet.htm#Style">WinGetExStyle</a> kann überprüft werden, ob ein Fenster die Immer-Im-Vordergrund-Eigenschaft hat.</p>
<p><strong>Siehe auch:</strong> <a href="#Parameters">Fensterparameter</a>, <a href="#return">Rückgabewert</a></p>

<h3 id="Bottom">WinMoveBottom</h3>
<p>Sendet das Fenster an das untere Ende des Stapels, so dass es unter allen anderen Fenstern liegt. Das gleiche kann auch durch Drücken von ALT+ESC erreicht werden.</p>
<pre class="Syntax"><span class="func">WinMoveBottom</span> <span class="optional">Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p><strong>Siehe auch:</strong> <a href="#Parameters">Fensterparameter</a>, <a href="#return">Rückgabewert</a></p>

<h3 id="Top">WinMoveTop</h3>
<p>Setzt ein Fenster an die Spitze des Stapels, ohne es explizit zu <a href="WinActivate.htm">aktivieren</a>.</p>
<pre class="Syntax"><span class="func">WinMoveTop</span> <span class="optional">Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Die Standardeinstellungen des Systems können bewirken, dass das Fenster trotzdem aktiviert wird. Darüber hinaus könnte diese Funktion keine Wirkung haben, wenn das Betriebssystem sich gegen Anwendungen schützt, die versuchen wollen, den Fokus vom Benutzer zu stehlen (das zum Beispiel davon abhängen kann, welches Fenster gerade aktiv ist und was der Benutzer gerade macht). Eine Möglichkeit, dies zu umgehen, ist es, das Fenster kurz <a href="#AlwaysOnTop">AlwaysOnTop</a> zu machen und es dann wieder auszuschalten.</p>
<p><strong>Siehe auch:</strong> <a href="#Parameters">Fensterparameter</a>, <a href="#return">Rückgabewert</a></p>

<h3 id="Enabled">WinSetEnabled</h3>
<p>Aktiviert oder deaktiviert ein Fenster.</p>
<pre class="Syntax"><span class="func">WinSetEnabled</span> Wert <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<dl>
  <dt>Wert</dt>
  <dd><p>Einer der folgenden case-insensitiven Text- oder Zahlwerten:</p><p>
    <code>ON</code> oder <code>1</code> (<a href="Variables.htm#True">true</a>) aktiviert die Einstellung.<br>
    <code>OFF</code> oder <code>0</code> (<a href="../Variables.htm#False">false</a>) deaktiviert die Einstellung.<br>
    <code>TOGGLE</code> oder <code>-1</code> setzt die Einstellung auf den entgegengesetzten Zustand.
  </p>
  <p>Fehlt dieser Parameter, gilt standardmäßig <code>TOGGLE</code>.</p></dd>
</dl>
<p>Wenn ein Fenster deaktiviert ist, kann der Benutzer es weder verschieben noch mit dessen Steuerelementen interagieren. Außerdem werden deaktivierte Fenster in der Alt-Tab-Liste nicht angezeigt.</p>
<p>Mit <a href="WinGet.htm#Style">WinGetStyle</a> kann überprüft werden, ob ein Fenster deaktiviert ist.</p>
<p><strong>Siehe auch:</strong> <a href="#Parameters">Fensterparameter</a>, <a href="#return">Rückgabewert</a></p>

<h3 id="Redraw">WinRedraw</h3>
<p>Versucht, die Darstellung/Inhalte eines Fensters zu aktualisieren, indem es dem Betriebssystem mitteilt, dass das Fensterrechteck eine Neuzeichnung benötigt.</p>
<pre class="Syntax"><span class="func">WinRedraw</span> <span class="optional">Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Falls diese Methode bei einem bestimmten Fenster nicht funktioniert, kann <a href="WinMove.htm">WinMove</a> ausprobiert werden. Wenn das auch nicht funktioniert, kann folgendes versucht werden:</p>
<pre><a href="WinHide.htm">WinHide</a> <i>Fenstertitel</i>
<a href="WinShow.htm">WinShow</a> <i>Fenstertitel</i></pre>
<p><strong>Siehe auch:</strong> <a href="#Parameters">Fensterparameter</a>, <a href="#return">Rückgabewert</a></p>

<h3 id="Style">WinSetStyle / WinSetExStyle</h3>
<p>Ändert den Style oder <u>Ex</u>tended Style eines Fensters.</p>
<pre class="Syntax"><span class="func">WinSetStyle</span> Wert <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span>
<span class="func">WinSetExStyle</span> Wert <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<dl>
  <dt>Wert</dt>
  <dd>
  <p>Verwenden Sie einen positiven Integer, um den Style des Fensters komplett zu überschreiben; also um den Style auf den angegebenen <em>Wert</em> zu setzen.</p>
  <p>Mit einem Pluszeichen (+), Minuszeichen (-) oder Zirkumflex (^) können Styles als numerische Zeichenketten jeweils hinzugefügt, entfernt oder umgeschaltet werden. Der neue Style-Wert wird wie folgt berechnet (AktuellerStyle kann mit <a href="WinGet.htm#Style">WinGetStyle/WinGetExStyle</a> abgerufen werden):</p>
  <table class="info">
    <tr>
      <th>Operation</th>
      <th>Präfix</th>
      <th>Beispiel-Zeichenkette</th>
      <th>Formel</th>
    </tr>
    <tr>
      <td>Hinzufügen</td>
      <td>+</td>
      <td>+0x80</td>
      <td><code>NeuerStyle := AktuellerStyle | Wert</code></td>
    </tr>
    <tr>
      <td>Entfernen</td>
      <td>-</td>
      <td>-0x80</td>
      <td><code>NeuerStyle := AktuellerStyle &amp; ~Wert</code></td>
    </tr>
    <tr>
      <td>Umschalten</td>
      <td>^</td>
      <td>^0x80</td>
      <td><code>NeuerStyle := AktuellerStyle ^ Wert</code></td>
    </tr>
  </table>
  <p>Wenn <em>Wert</em> ein negativer Integer ist, wird er wie die entsprechende numerische Zeichenkette behandelt.</p>
  <p>Um + oder ^ in einem Ausdruck als direkt geschriebenen Text zu verwenden, setzt man den Präfix oder Wert in Anführungszeichen. Zum Beispiel: <code>WinSetStyle("+0x80")</code> oder <code>WinSetStyle("^" UmzuschaltenderStyle)</code>. Ansonsten würde beispielsweise der <a href="../Variables.htm#Expressions">Ausdruck</a> <code><a href="../Variables.htm#unary">+123</a></code> 123 erzeugen (also ohne Präfix) und <code>^123</code> einen Syntaxfehler auslösen.</p>
  </dd>
</dl>
<p>Nach dem Durchführen einiger Style-Änderungen an ein sichtbares Fenster ist es wahrscheinlich notwendig, das Fenster via <a href="#Redraw">WinRedraw</a> neu zu zeichnen. Die <a href="../misc/Styles.htm">Style-Tabelle</a> listet einige der häufig verwendeten Styles auf. Beispiele:</p>
<pre>WinSetStyle "-0xC00000", "A"  <em>; Entfernt die Titelleiste des aktiven Fensters (WS_CAPTION).</em>
WinSetExStyle "^0x80", <i>Fenstertitel</i>  <em>; Schaltet das WS_EX_TOOLWINDOW-Attribut um, das das Fenster in der Alt-Tab-Liste hinzufügt/entfernt.</em></pre>
<p><strong>Siehe auch:</strong> <a href="#Parameters">Fensterparameter</a>, <a href="#return">Rückgabewert</a>, <a href="WinGet.htm#Style">WinGetStyle/WinGetExStyle</a></p>

<h3 id="Region">WinSetRegion</h3>
<p>Ändert die Form eines Fensters zu einem Rechteck, Polygon oder einer Ellipse.</p>
<pre class="Syntax"><span class="func">WinSetRegion</span> <span class="optional">Optionen, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Fehlt der <em>Optionen</em>-Parameter, wird der originale/normale Anzeigebereich des Fensters wiederhergestellt. Ansonsten können eine oder mehrere der folgenden Optionen angegeben werden, die mit Leerzeichen voneinander getrennt werden müssen:</p>
<p><strong>Wn</strong>: Breite des Rechtecks oder der Ellipse. Zum Beispiel: <code>w200</code>.<br>
<strong>Hn</strong>: Höhe des Rechtecks oder der Ellipse. Zum Beispiel: <code>h300</code>.<br>
<strong>X-Y</strong>: Ein oder mehrere X-Y-Koordinatenpaare. Bei dem Beispiel <code>200-0</code> wäre 200 die X-Koordinate und 0 die Y-Koordinate.<br>
<strong>E</strong>: Macht die Region zu einer Ellipse statt zu einem Rechteck. Diese Option ist nur gültig, wenn <strong>W</strong> und <strong>H</strong> vorhanden sind.<br>
<strong>R[w-h]</strong>: Macht die Region zu einem Rechteck mit abgerundeten Ecken. Bei dem Beispiel <code>R30-30</code> wäre jede Ecke eine 30x30 Ellipse. Wenn <strong>w-h</strong> fehlt, wird 30-30 verwendet. <strong>R</strong> ist nur gültig, wenn <strong>W</strong> und <strong>H</strong> vorhanden sind.</p>
<p><strong>Rechteck oder Ellipse</strong>: Wenn die Optionen <strong>W</strong> und <strong>H</strong> vorhanden sind, wird der neue Anzeigebereich ein Rechteck sein, dessen linke obere Ecke das erste (und nur dieses) <strong>X-Y</strong>-Koordinatenpaar ist. Wenn dazu noch die <strong>E</strong>-Option vorhanden ist, wird der neue Anzeigebereich eine Ellipse statt ein Rechteck sein. Zum Beispiel: <code>WinSetRegion "50-0 W200 H250 E", <i>Fenstertitel</i></code>.</p>
<p><strong>Polygon</strong>: Wenn die Optionen <strong>W</strong> und <strong>H</strong> fehlen, wird der neue Anzeigebereich ein Polygon (Vieleck) sein, dessen Ecken mehrere <strong>X-Y</strong>-Koordinatenpaare sind (jedes Koordinatenpaar ist ein Punkt innerhalb des Fensters, relativ zu dessen oberen linken Ecke). Wenn zum Beispiel drei Koordinatenpaare angegeben sind, wird der neue Anzeigebereich in den meisten Fällen ein Dreieck sein. Die Reihenfolge der Koordinaten zueinander ist manchmal wichtig. Zusätzlich kann das Wort <strong>Wind</strong> in den <em>Optionen</em> angegeben werden, um die Kurvenmethode zur Bestimmung des Polygonbereichs zu verwenden.</p>
<p><a href="#return">ErrorLevel</a> und der <a href="#return">Rückgabewert</a> der Funktion werden auf einen Wert gesetzt, der abhängig vom Erfolg oder Misserfolg der Funktion ist. Fehler treten auf, wenn: 1) das Zielfenster nicht vorhanden ist; 2) eine oder mehrere <em>Optionen</em> ungültig sind; 3) mehr als 2000 Koordinatenpaare angegeben sind; oder 4) die angegebene Region ungültig ist oder nicht auf das Zielfenster angewendet werden kann.</p>
<p>Am unteren Ende dieser Seite finden Sie Beispiele, die zeigen, wie man diese Funktion verwenden kann.</p>
<p><strong>Siehe auch:</strong> <a href="#Parameters">Fensterparameter</a>, <a href="#return">Rückgabewert</a></p>

<h3 id="Transparent">WinSetTransparent</h3>
<p>Macht ein Fenster halbtransparent.</p>
<pre class="Syntax"><span class="func">WinSetTransparent</span> <span class="optional">N, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<dl>
  <dt>N</dt>
  <dd><p>Um ein Fenster transparent zu machen, gibt man eine Zahl zwischen 0 und 255 an, die den Grad der Transparenz bestimmt: 0 macht das Fenster durchsichtig und 255 undurchsichtig.</p>
  <p>Mit dem Wort <code>OFF</code> (case-insensitiv) kann die Transparenz eines Fensters komplett deaktiviert werden.</p>
  </dd>
</dl>
<p>In Hinsicht auf Performance und Ressourcennutzung ist eine deaktivierte Transparenz besser als eine auf 255 gesetzte Transparenz (aber wahrscheinlich nur in Windows XP oder wenn die Desktopgestaltung deaktiviert ist).</p>
<p id="TransLimit"><strong>Bekannte Einschränkungen für Transparent und <a href="#TransColor">TransColor</a></strong>:</p>
<ul>
  <li>Setzt man "Transparent" auf 255, bevor man es via OFF deaktiviert, können Probleme beim Neuzeichnen, wie z. B. ein schwarzer Hintergrund, verhindert werden. Wenn das Fenster weiterhin nicht korrekt gezeichnet werden kann, finden Sie unter <a href="#Redraw">Redraw</a> eine mögliche Übergangslösung.</li>
  <li>Um die bestehende <a href="#TransColor">TransColor</a>-Einstellung eines Fensters zu ändern, ist es eventuell erforderlich, die Transparenz zu auszuschalten, bevor die Änderung vollzogen werden kann.</li>
</ul>
<p><strong>Tipp</strong>: Mit <code>WinSetTransparent 150, "ahk_class Shell_TrayWnd"</code> kann die Taskleiste transparent gemacht werden. Das folgende Beispiel zeigt, wie das Startmenü transparent gemacht werden kann:</p>
<pre>DetectHiddenWindows True
WinSetTransparent 150, "ahk_class BaseBar"  <em>; Um die Untermenüs des Startmenüs ebenfalls transparent zu machen, fügt man das nachfolgende Skript ein.</em></pre>
<p>Um alle oder bestimmte Menüs im gesamten System transparent zu machen, lässt man ein Skript wie das folgende dauerhaft laufen. Beachten Sie, dass so ein Skript nur die Menüs von anderen Skripten transparent machen kann, nicht seine eigenen:</p>
<pre>SetTimer "AufMenüWarten", 5
return  <em>; Ende des automatischen Ausführungsbereichs.</em>

AufMenüWarten:
DetectHiddenWindows True  <em>; Könnte Menüs früher erkennen.</em>
If WinExist("ahk_class #32768")
    WinSetTransparent 150  <em>; Verwendet das gefundene Fenster von der darüberliegenden Zeile.</em>
return</pre>
<p><strong>Siehe auch:</strong> <a href="#Parameters">Fensterparameter</a>, <a href="#return">Rückgabewert</a>, <a href="WinGet.htm#Transparent">WinGetTransparent</a></p>

<h3 id="TransColor">WinSetTransColor</h3>
<pre class="Syntax"><span class="func">WinSetTransColor</span> Farbe <span class="optional">N</span> <span class="optional">, Optionen, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<p>Macht alle Pixel der ausgewählten Farbe innerhalb des Zielfensters unsichtbar, so dass der Inhalt hinter dem Fenster durchscheinen kan. Klickt der Benutzer auf einen unsichtbaren Pixel, wird sich dieser Klick auf das Fenster dahinter auswirken. Fügen Sie in <em>Farbe</em> einen Farbnamen oder RGB-Wert ein (siehe <a href="../misc/Colors.htm">Farbtabelle</a> oder verwenden Sie <a href="PixelGetColor.htm">PixelGetColor</a> im RGB-Modus). Um den sichtbaren Bereich eines Fensters zusätzlich transparent zu machen, fügt man ein Leerzeichen (kein Komma) gefolgt von der Transparenzstufe (0-255) ein. Zum Beispiel: <code>WinSetTransColor "EEAA99 150", <i>Fenstertitel</i></code>.</p>
<p>TransColor wird oft verwendet, um Bildschirmanzeigen (OSD) und andere visuelle Effekte zu erzeugen. Ein Beispiel dazu finden Sie auf der <a href="GuiCreate.htm#OSD">GUI-Seite ganz unten</a>.</p>
<p>Das Wort OFF kann angegeben werden, um die Transparenz eines Fensters komplett zu deaktivieren. Die folgenden Zeilen sind funktiongemäß identisch:</p>
<pre>WinSetTransparent "Off", <i>Fenstertitel</i>
WinSetTransColor "Off", <i>Fenstertitel</i></pre>
<p>Bekannte Einschränkungen: Siehe <a href="#TransLimit">obere</a> Liste.</p>
<p><strong>Siehe auch:</strong> <a href="#Parameters">Fensterparameter</a>, <a href="#return">Rückgabewert</a>, <a href="WinGet.htm#TransColor">WinGetTransColor</a></p>

<h3 id="Parameters">Fensterparameter</h3>
<p>Alle Funktionen auf dieser Seite nutzen die folgenden Parameter, um das Zielfenster zu identifizieren:</p>
<dl>

  <dt>Fenstertitel</dt>
  <dd><p>Ein Fenstertitel oder sonstige Kriterien, die das Zielfenster ermitteln sollen. Siehe <a href="../misc/WinTitle.htm">Fenstertitel</a>.</p></dd>

  <dt>Fenstertext</dt>
  <dd><p>In diesem Parameter kann eine Zeichenkette angegeben werden, die in einem Textelement des Zielfensters vorkommt (abrufbar mit Windows Spy). Versteckte Textelemente werden auch erkannt, sofern <a href="DetectHiddenText.htm">DetectHiddenText</a> aktiv ist.</p></dd>

  <dt>Titelausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Titel diesen Wert enthalten.</p></dd>

  <dt>Textausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Textelemente diesen Wert enthalten.</p></dd>

</dl>

<h3 id="return">Rückgabewert</h3>
<p>Alle Funktionen auf dieser Seite geben bei Erfolg eine 1 (<a href="Variables.htm#True">true</a>) und bei Misserfolg eine 0 (<a href="../Variables.htm#False">false</a>) zurück. Der Rückgabewert ist nur zugänglich, wenn die Funktionssyntax verwendet wird.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> hingegen wird bei Erfolg auf 0 (false) oder bei Misserfolg auf 1 (true) gesetzt. ErrorLevel wird immer gesetzt.</p>
<p>Ein Fehler tritt auf, wenn das Zielfenster nicht gefunden wird oder die Änderung nicht angewendet werden kann.</p>

<h3>Bemerkungen</h3>
<p>Fenstertitel und -texte unterscheiden zwischen Groß- und Kleinschreibung. Solange <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist, werden versteckte Fenster nicht wahrgenommen.</p>

<h3>Siehe auch</h3>
<p><a href="WinGet.htm">WinGet</a>, <a href="WinHide.htm">WinHide</a>, <a href="WinSetTitle.htm">WinSetTitle</a>, <a href="WinMove.htm">WinMove</a>, <a href="WinActivate.htm">WinActivate</a>, <a href="Control.htm">Control-Funktionen</a></p>

<h3>Beispiele</h3>
<pre class="NoIndent">WinSetTransparent 200, "Unbenannt - Editor" <em>; Macht das Fenster ein wenig transparent.</em>
WinSetTransColor "White", "Unbenannt - Editor" <em>; Macht alle weißen Pixel unsichtbar.</em>
WinSetAlwaysOnTop "Toggle", "Rechner" <em>; Schaltet den "Immer im Vordergrund"-Zustand des Taschenrechners um.</em>

<em>; Längeres Beispiel:
; Hier sind einige Hotkeys, die den Effekt von "Transparent" und
; "TransColor" veranschaulichen. HINWEIS: Drücken Sie einen dieser Hotkeys, während sich der Mauszeiger
; über einen via TransColor unsichtbar gemachten Pixel befindet, wird er
; stattdessen das Fenster hinter dem Pixel beeinflussen!</em>

#t::  <em>; Drücken Sie WIN+T, um die Farbe unter dem Mauszeiger unsichtbar zu machen.</em>
MouseGetPos MausX, MausY, MausWin
MausRGB := PixelGetColor(MausX, MausY)
<em>; Es scheint so, als müsste man erst jede vorhandene Transparenz ausschalten:</em>
WinSetTransColor "Off", "ahk_id " MausWin
WinSetTransColor MausRGB " 220", "ahk_id " MausWin
return

#o::  <em>; Drücken Sie WIN+O, um die Transparenz des Fensters unter der Maus auszuschalten.</em>
MouseGetPos ,, MausWin
WinSetTransColor "Off", "ahk_id " MausWin
return

#g::  <em>; Drücken Sie WIN+G, um die aktuellen Einstellungen des Fensters unter der Maus anzuzeigen.</em>
MouseGetPos ,, MausWin
Transparent := WinGetTransparent("ahk_id " MausWin)
TransColor := WinGetTransColor("ahk_id " MausWin)
ToolTip "Durchsichtigkeit:`t" Transparent "`nTransparenzfarbe:`t" TransColor
return

<em>; Beispiele für "WinSet Region":</em>
WinSetRegion "50-0 W200 H250", Fenstertitel <em>; Macht alle Fensterbereiche außerhalb dieses Rechtecks unsichtbar.</em>
WinSetRegion "50-0 W200 H250 R40-40", Fenstertitel <em>; Das gleiche wie oben, aber mit abgerundeten Ecken.</em>
WinSetRegion "50-0 W200 H250 E", Fenstertitel <em>; Eine Ellipse anstelle eines Rechtecks.</em>
WinSetRegion "50-0 250-0 150-250", Fenstertitel <em>; Ein nach unten gerichtetes Dreieck.</em>
WinSetRegion , Fenstertitel <em>; Stellt den originalen/normalen Anzeigebereich des Fensters wieder her.</em>

<em>; Hier ist eine Region mit einem komplexeren Bereich. Es erstellt ein durchsichtiges rechteckiges Loch innerhalb eines Fensters.
; Es sind zwei Rechtecke unten angegeben: ein Äußeres und ein Inneres. Jedes Rechteck besteht aus 5 X/Y-Koordinatenpaaren, weil das erste Koordinatenpaar am Ende wiederholt wird, um das Rechteck wieder zu schließen.</em>
WinSetRegion "0-0 300-0 300-300 0-300 0-0   100-100 200-100 200-200 100-200 100-100", Fenstertitel</pre>

</body>
</html>
