<!DOCTYPE HTML>
<html>
<head>
<title>ControlGetPos</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
</head>
<body>

<h1>ControlGetPos</h1>

<p>Ermittelt die Position und Größe eines Steuerelements.</p>

<pre class="Syntax"><span class="func">ControlGetPos</span> <span class="optional">X, Y, Breite, Höhe, Steuerelement, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<h3>Parameter</h3>
<dl>

  <dt>X, Y</dt>
  <dd><p>Namen der Variablen, in denen die Koordinaten X und Y der oberen linken Ecke des <em>Steuerelements</em> gespeichert werden sollen (in Pixel). Die Koordinaten beziehen sich auf die linke obere Ecke des Zielfenster-<a href="CoordMode.htm#Client">Clientbereich</a>s, und sind somit die gleichen wie die von <a href="ControlMove.htm">ControlMove</a>.</p>
      <p>Sobald ein Parameter weggelassen wird, wird dessen Wert entsprechend nicht gespeichert.</p></dd>

  <dt>Breite/Höhe</dt>
  <dd><p>Namen der Variablen, in denen die Breite und Höhe des <em>Steuerelements</em> gespeichert werden sollen (in Pixel). Sobald ein Parameter weggelassen wird, wird der entsprechende Wert nicht gespeichert.</p></dd>

  <dt>Steuerelement</dt>
  <dd><p>Kann entweder das ClassNN (Klassenname und Instanznummer des Steuerelements) oder der Text des Steuerelements sein, das beides mit Windows Spy ermittelt werden kann. Verwendet man Text, ist das Übereinstimmungsverhalten abhängig von <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a>. Wenn dieser Parameter leer ist, wird das oberste Steuerelement des Fensters benutzt.</p>
    <p>Um ein Steuerelement per HWND (Windows Handle) anzusteuern, muss der <em>Steuerelement</em>-Parameter leer gelassen und <code>ahk_id %SteuerelementHwnd%</code> im <em>Fenstertitel</em>-Parameter angegeben werden (funktioniert auch bei versteckten Steuerelementen, selbst wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist). Das HWND eines Steuerelements wird üblicherweise per <a href="Control.htm#GetHwnd">ControlGetHwnd</a>, <a href="MouseGetPos.htm">MouseGetPos</a> oder <a href="DllCall.htm">DllCall</a> abgerufen.</p></dd>

  <dt>Fenstertitel</dt>
  <dd><p>Ein Fenstertitel oder sonstige Kriterien, die das Zielfenster ermitteln sollen. Siehe <a href="../misc/WinTitle.htm">Fenstertitel</a>.</p></dd>

  <dt>Fenstertext</dt>
  <dd><p>In diesem Parameter kann eine Zeichenkette angegeben werden, die in einem Textelement des Zielfensters vorkommt (abrufbar mit Windows Spy). Versteckte Textelemente werden auch erkannt, sofern <a href="DetectHiddenText.htm">DetectHiddenText</a> aktiv ist.</p></dd>

  <dt>Titelausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Titel diesen Wert enthalten.</p></dd>

  <dt>Textausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Textelemente diesen Wert enthalten.</p></dd>

</dl>

<h3>Bemerkungen</h3>
<p>Wenn keine passenden Fenster oder Steuerelemente gefunden werden, wird jede Ausgabevariable leer gemacht.</p>
<p>m Gegensatz zu Befehlen, die ein Steuerelement ändern, hat ControlGetPos keine automatische Verzögerung (d. h. ControlGetPos wird nicht von <a href="SetControlDelay.htm">SetControlDelay</a> beeinflusst).</p>
<p>Mit <a href="MouseGetPos.htm">MouseGetPos</a> kann das ClassNN oder HWND vom Steuerelement erfasst werden, das sich gerade eben unter dem Mauszeiger befindet. Mit <a href="WinGet.htm">WinGet ControlList</a> kann eine Liste mit Steuerelementen von einem Fenster abgerufen werden.</p>
<p>Fenstertitel und -texte unterscheiden zwischen Groß- und Kleinschreibung. Solange <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist, werden versteckte Fenster nicht wahrgenommen.</p>
<h3>Siehe auch</h3>
<p><a href="ControlMove.htm">ControlMove</a>, <a href="WinGetPos.htm">WinGetPos</a>, <a href="Control.htm">Control-Funktionen</a>, <a href="ControlGetText.htm">ControlGetText</a>, <a href="ControlSetText.htm">ControlSetText</a>, <a href="ControlClick.htm">ControlClick</a>, <a href="ControlFocus.htm">ControlFocus</a>, <a href="ControlSend.htm">ControlSend</a></p>
<h3>Beispiel</h3>
<pre class="NoIndent"><em>; Dieses Beispiel aktualisiert sich laufend und zeigt Name und Position
; des Steuerelements an, welches sich gerade unter dem Mauszeiger befindet:</em>
Loop
{
    Sleep, 100
    MouseGetPos, , , BestimmtesFenster, BestimmtesSteuerelement
    ControlGetPos, x, y, w, h, %BestimmtesSteuerelement%, ahk_id %BestimmtesFenster%
    ToolTip, %BestimmtesSteuerelement%`nX%X%`tY%Y%`nW%W%`t%H%
}</pre>

</body>
</html>
