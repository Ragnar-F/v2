<!DOCTYPE HTML>
<html>
<head>
<title>ControlGetFocus</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
</head>
<body>

<h1>ControlGetFocus</h1>

<p>Ermittelt, welches Steuerelement im Zielfenster den Eingabefokus hat.</p>

<pre class="Syntax">ClassNN := <span class="func">ControlGetFocus</span>(<span class="optional">Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span>)</pre>
<h3>Parameter</h3>
<dl>

  <dt>Fenstertitel</dt>
  <dd><p>Ein Fenstertitel oder sonstige Kriterien, die das Zielfenster ermitteln sollen. Siehe <a href="../misc/WinTitle.htm">Fenstertitel</a>.</p></dd>

  <dt>Fenstertext</dt>
  <dd><p>In diesem Parameter kann eine Zeichenkette angegeben werden, die in einem Textelement des Zielfensters vorkommt (abrufbar mit Windows Spy). Versteckte Textelemente werden auch erkannt, sofern <a href="DetectHiddenText.htm">DetectHiddenText</a> aktiv ist.</p></dd>

  <dt>Titelausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Titel diesen Wert enthalten.</p></dd>

  <dt>Textausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Textelemente diesen Wert enthalten.</p></dd>

</dl>

<h3>Rückgabewert</h3>
<p>Gibt das ClassNN des Steuerelements zurück; also den Klassennamen des Steuerelements, gefolgt von dessen Reihenfolgennummer innerhalb des übergeordneten Fensters, z. B. Button12.</p>
<p>Wenn ein Problem auftrat oder wenn keines der Steuerelemente im Zielfenster den Tastaturfokus hat, ist der Rückgabewert leer.</p>

<h3>ErrorLevel</h3>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 1 gesetzt, wenn der Tastaturfokus nicht ermittelt werden konnte, ansonsten auf 0. Ein ErrorLevel von 1 bedeutet in der Regel, dass das Fenster nicht existiert.</p>

<h3>Bemerkungen</h3>
<p>Das Steuerelement, welches mit diesem Befehl ermittelt wird, ist auch das Steuerelement, welches die Tastatureingaben des Benutzers empfängt.</p>
<p>Das Fenster muss aktiv sein, damit ein Steuerelement fokussiert sein kann, aber auch in einem aktiven Fenster kann manchmal ein fokussiertes Steuerelement fehlen. Wenn das Zielfenster gefunden wurde, aber keines seiner Steuerelemente den Tastaturfokus hat, wird ErrorLevel auf 0 gesetzt und der Rückgabewert leer gemacht.</p>
<p>Fenstertitel und -texte unterscheiden zwischen Groß- und Kleinschreibung. Solange <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist, werden versteckte Fenster nicht wahrgenommen.</p>
<h3>Siehe auch</h3>
<p><a href="ControlFocus.htm">ControlFocus</a>, <a href="ControlMove.htm">ControlMove</a>, <a href="ControlClick.htm">ControlClick</a>, <a href="ControlGetText.htm">ControlGetText</a>, <a href="ControlSetText.htm">ControlSetText</a>, <a href="ControlSend.htm">ControlSend</a></p>
<h3>Beispiel</h3>
<pre class="NoIndent">Fokussiert := ControlGetFocus("Unbenannt - Editor")
if ErrorLevel
    MsgBox "Das Zielfenster existiert nicht."
else
    MsgBox "Steuerelement mit Tastaturfokus = " Fokussiert</pre>

</body>
</html>
