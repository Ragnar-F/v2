<!DOCTYPE HTML>
<html>
<head>
<title>ControlGetFocus</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
</head>
<body>

<h1>ControlGetFocus</h1>

<p>Ermittelt, welches Steuerelement des Zielfensters den Eingabefokus hat, falls vorhanden.</p>

<pre class="Syntax">ClassNN := <span class="func">ControlGetFocus</span>(<span class="optional">Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span>)</pre>
<h3>Parameter</h3>
<dl>

  <dt>Fenstertitel</dt>
  <dd><p>Der Titel oder andere Möglichkeiten zum Identifizieren des Zielfensters. Weitere Informationen finden Sie auf der Seite <a href="../misc/WinTitle.htm">Fenstertitel-Parameter &amp; Zuletzt Gefundenes Fenster</a>.</p></dd>

  <dt>Fenstertext</dt>
  <dd><p>Eine Zeichenkette, die in einem der Textelemente des Zielfensters enthalten ist (eventuell vorhandene Textelemente können mit dem mitgelieferten Windows Spy Tool aufgedeckt werden). Versteckte Textelemente werden nur erkannt, wenn <a href="DetectHiddenText.htm">DetectHiddenText</a> eingeschaltet ist.</p></dd>

  <dt>Titelausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Titel diesen Wert enthalten.</p></dd>

  <dt>Textausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Textelemente diesen Wert enthalten.</p></dd>

</dl>

<h3>Rückgabewert</h3>
<p>Gibt das ClassNN des Steuerelements zurück; also den Klassennamen des Steuerelements, gefolgt von dessen Reihenfolgennummer innerhalb des übergeordneten Fensters, z. B. Button12.</p>
<p>Wenn ein Problem auftrat oder wenn keines der Steuerelemente im Zielfenster den Tastaturfokus hat, ist der Rückgabewert leer.</p>

<h3>ErrorLevel</h3>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 1 gesetzt, wenn der Tastaturfokus nicht ermittelt werden konnte, ansonsten auf 0. Ein ErrorLevel von 1 bedeutet in der Regel, dass das Fenster nicht existiert.</p>

<h3>Bemerkungen</h3>
<p>Das abgerufene Steuerelement ist auch das Steuerelement, das den Tastaturfokus hat; solche Steuerelemente sind die Anlaufstelle für jegliche Tastatureingaben des Benutzers.</p>
<p>Das Fenster muss aktiv sein, damit ein Steuerelement fokussiert sein kann, aber auch in einem aktiven Fenster kann manchmal ein fokussiertes Steuerelement fehlen. Wenn das Zielfenster gefunden wurde, aber keines seiner Steuerelemente den Tastaturfokus hat, wird ErrorLevel auf 0 gesetzt und der Rückgabewert leer gemacht.</p>
<p>Fenstertitel und -texte unterscheiden zwischen Groß- und Kleinschreibung. Versteckte Fenster werden nur erkannt, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> eingeschaltet ist.</p>
<h3>Siehe auch</h3>
<p><a href="ControlFocus.htm">ControlFocus</a>, <a href="ControlMove.htm">ControlMove</a>, <a href="ControlClick.htm">ControlClick</a>, <a href="ControlGetText.htm">ControlGetText</a>, <a href="ControlSetText.htm">ControlSetText</a>, <a href="ControlSend.htm">ControlSend</a></p>
<h3>Beispiel</h3>
<pre class="NoIndent">Fokussiert := ControlGetFocus("Unbenannt - Editor")
if ErrorLevel
    MsgBox "Das Zielfenster existiert nicht."
else
    MsgBox "Steuerelement mit Tastaturfokus = " Fokussiert</pre>

</body>
</html>
