<!DOCTYPE HTML>
<html>
<head>
<title>FormatTime</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
<style type="text/css">
.red {color: #FF0000}
</style>
</head>
<body>

<h1>FormatTime</h1>

<p>Transformiert einen <a href="FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a>-Zeitstempel in das angegebene Datum/Zeit-Format.</p>

<pre class="Syntax">AusgabeVar := <span class="func">FormatTime</span>(<span class="optional"><a href="FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a>, Format</span>)</pre>
<h3>Parameter</h3>
<dl>

  <dt>AusgabeVar</dt>
  <dd><p>Name der Variable, in der das Ergebnis gespeichert werden soll.</p></dd>

  <dt>YYYYMMDD...</dt>
  <dd><p>Lassen Sie diesen Parameter leer, um die gegenwärtige Ortszeit zu verwenden. Ansonsten können Sie den kompletten oder führenden Teil eines Zeitstempels im <a href="FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a>-Format angeben. Wenn der Datums- und/oder Zeitbereich ungültig ist (z. B. der 29. Februar eines Nicht-Schaltjahrs), wird der entsprechende Bereich in <em>AusgabeVar</em> weggelassen. Trotz der Tatsache, dass nur Jahre zwischen 1601 und 9999 unterstützt werden, können formatierte Zeiten vor 1601 erzeugt werden, solange der Zeitbereich gültig ist.</p></dd>

  <dt>Format</dt>
  <dd><p>Fehlt dieser Parameter, wird standardmäßig die Zeit gefolgt vom langen Datum verwendet, die beide gemäß dem Gebietsschema des aktuellen Benutzers formatiert werden. Zum Beispiel: 10:24 Freitag, 30. April 2010</p>
      <p>Ansonsten können Sie eines oder mehrere der folgenden Datum-Zeit-Formate angeben und direkt geschriebene Leer- und Satzzeichen dazwischen einfügen (Kommas müssen nicht mit einem Escapezeichen versehen werden; sie können normal verwendet werden). Beachten Sie im folgenden Beispiel, dass das M großgeschrieben werden muss: d.M.yyyy h:mm:tt</p></dd>

</dl>

<h3>Datumsformate <span class="red">(Groß-/Kleinschreibung-sensitiv)</span></h3>
<table class="info">
  <tr>
    <td style="width:15%">d</td>
    <td>Tag des Monats ohne führende Null (1 - 31)</td>
  </tr>
  <tr>
    <td>dd</td>
    <td>Tag des Monats mit führender Null (01 - 31)</td>
  </tr>
  <tr>
    <td>ddd</td>
    <td>Kurzschreibweise des Wochentags (z. B. Mo) in der Sprache des aktuellen Benutzers</td>
  </tr>
  <tr>
    <td>dddd</td>
    <td>Vollständiger Name des Wochentags (z. B. Montag) in der Sprache des aktuellen Benutzers</td>
  </tr>
  <tr>
    <td>M</td>
    <td>Monat ohne führende Null (1 - 12)</td>
  </tr>
  <tr>
    <td>MM</td>
    <td>Monat mit führende Null (01 - 12)</td>
  </tr>
  <tr>
    <td>MMM</td>
    <td>Kurzschreibweise des Monats (z. B. Jan) in der Sprache des aktuellen Benutzers</td>
  </tr>
  <tr>
    <td>MMMM</td>
    <td>Vollständiger Name des Monats (z. B. Januar) in der Sprache des aktuellen Benutzers</td>
  </tr>
  <tr>
    <td>y</td>
    <td>Jahr ohne Jahrhundert und ohne führende Null (0 - 99)</td>
  </tr>
  <tr>
    <td>yy</td>
    <td>Jahr ohne Jahrhundert und mit führender Null (00 - 99)</td>
  </tr>
  <tr>
    <td>yyyy</td>
    <td>Jahr mit Jahrhundert. Zum Beispiel: 2005</td>
  </tr>
  <tr>
    <td>gg</td>
    <td>Zeitrechnung/Ära gemäß dem Gebietsschema des aktuellen Benutzers (z. B. n. Chr.)</td>
  </tr>
</table>
<h3>Zeitformate <span class="red">(Groß-/Kleinschreibung-sensitiv)</span></h3>
<table class="info">
  <tr>
    <td style="width:15%">h</td>
    <td>Stunde ohne führende Null; 12-Stunden-Format (1 - 12)</td>
  </tr>
  <tr>
    <td>hh</td>
    <td>Stunde mit führender Null; 12-Stunden-Format (01 - 12)</td>
  </tr>
  <tr>
    <td>H</td>
    <td>Stunde ohne führende Null; 24-Stunden-Format (0 - 23)</td>
  </tr>
  <tr>
    <td>HH</td>
    <td>Stunde mit führender Null; 24-Stunden-Format (00 - 23)</td>
  </tr>
  <tr>
    <td>m</td>
    <td>Minute ohne führende Null (0 - 59)</td>
  </tr>
  <tr>
    <td>mm</td>
    <td>Minute mit führender Null (00 - 59)</td>
  </tr>
  <tr>
    <td>s</td>
    <td>Sekunde ohne führende Null (0 - 59)</td>
  </tr>
  <tr>
    <td>ss</td>
    <td>Sekunde mit führender Null (00 - 59)</td>
  </tr>
  <tr>
    <td>t</td>
    <td>Einzelzeichen-Zeitmarker wie A oder P (gemäß dem Gebietsschema)</td>
  </tr>
  <tr>
    <td>tt</td>
    <td>Mehrfachzeichen-Zeitmarker wie AM oder PM (gemäß dem Gebietsschema)</td>
  </tr>
</table>
<h3>Die folgenden Formate sind <span class="red">alleinstehend</span>; das heißt, dass keine anderen Formate oder Texte im <em>Format</em>-Parameter angegeben werden dürfen. Diese Formate sind nicht Groß-/Kleinschreibung-sensitiv.</h3>
<table class="info">
  <tr>
    <td style="width:15%">(Leer)</td>
    <td>Lassen Sie <em>Format</em> leer, um die Zeit gefolgt vom langen Datum zu erzeugen. Zum Beispiel: 10:24 Freitag, 30. April 2010</td>
  </tr>
  <tr>
    <td>Time</td>
    <td>Die Zeitdarstellung gemäß dem Gebietsschema des aktuellen Benutzers, z. B. 12:04</td>
  </tr>
  <tr>
    <td>ShortDate</td>
    <td>Das kurze Datum gemäß dem Gebietsschema des aktuellen Benutzers, z. B. 30.04.2010</td>
  </tr>
  <tr>
    <td>LongDate</td>
    <td>Das lange Datum gemäß dem Gebietsschema des aktuellen Benutzers, z. B. Freitag, 30. April 2010</td>
  </tr>
  <tr>
    <td>YearMonth</td>
    <td>Jahr-Monat-Format gemäß dem Gebietsschema des aktuellen Benutzers, z. B. April 2010</td>
  </tr>
  <tr>
    <td>YDay</td>
    <td>Tag des Jahres ohne führende Nullen (1 - 366)</td>
  </tr>
  <tr>
    <td>YDay0</td>
    <td>Tag des Jahres mit führenden Nullen (001 - 366)</td>
  </tr>
  <tr>
    <td>WDay</td>
    <td>Wochentag (1 - 7). Sonntag ist 1.</td>
  </tr>
  <tr>
    <td>YWeek</td>
    <td>Das vollständige Jahr und die Wochennummer gemäß ISO 8601. Zum Beispiel: 200453. Wenn die Woche mit dem 1. Januar mindestens vier Tage im neuen Jahr hat, ist sie Woche 1. Ansonsten ist sie die letzte Woche des vorherigen Jahres, und die nachfolgende Woche die erste Woche des neuen Jahres. Folglich sind sowohl der 4. Januar als auch der erste Donnerstag im Januar immer in Woche 1.</td>
  </tr>
</table>
<h3>Zusätzliche Optionen</h3>
<p>Der <em>YYYYMMDDHH24MISS</em>-Parameter kann folgende Optionen enthalten, die direkt nach dem Zeitstempel erfolgen müssen (gibt es keinen Zeitstempel, können diese Optionen auch alleine stehen). Beachten Sie im folgenden Beispiel, dass Kommas zwischen den letzten vier Elementen fehlen:</p>
<pre>AusgabeVar := FormatTime("20040228 LSys D1 D4")</pre>
<p><strong>R</strong>: Umkehren. Zeigt das Datum vor der Zeit an (nur sinnvoll, wenn <em>Format</em> leer ist).</p>
<p><strong>Ln</strong>: Wenn diese Option <em>nicht</em> vorhanden ist, wird das Gebietsschema des aktuellen Benutzers zum Formatieren der Zeichenkette verwendet. Um stattdessen das Gebietsschema des Betriebssystems zu verwenden, gibt man LSys an. Um ein spezifisches Gebietsschema zu verwenden, gibt man den Buchstaben L an, gefolgt einem dezimalen oder hexadezimalen Gebietsschemaidentifikator (LCID). Informationen darüber, wie sich eine LCID zusammensetzt, finden Sie unter <a href="http://www.microsoft.com">www.microsoft.com</a> mit folgendem Suchbegriff: Locale Identifiers</p>
<p><strong>Dn</strong>: Datumsoptionen. Geben Sie für <strong>n</strong> eine der folgenden Zahlen an:<br>
  0: Erzwingt die Verwendung der Standardoptionen. Dies führt dazu, dass das kurze Datum wirksam wird. <br>
  1: Verwendet das kurze Datum (nur sinnvoll, wenn <em>Format</em> leer ist; nicht kompatibel mit 2 und 8).<br>
  2: Verwendet das lange Datum (nur sinnvoll, wenn <em>Format</em> leer ist; nicht kompatibel mit 1 und 8).<br>
  4: Verwendet einen alternativen Kalender (falls vorhanden).<br>
  8: Verwendet das Jahr-Monat-Format (nur sinnvoll, wenn <em>Format</em> leer ist; nicht kompatibel mit 1 und 2).<br>
  0x10: Fügt Markierungen für das Links-nach-Rechts-Leselayout hinzu.<br>
  0x20: Fügt Markierungen für Rechts-nach-Links-Leselayout hinzu.<br>
  0x80000000: Bewirkt, dass alle Änderungen, die der Benutzer eventuell am Standarddatumsformat des Systems durchgeführt hat, ignoriert werden. <br>
0x40000000: Verwendet zum Übersetzen der Zeichenkettencodierung den ANSI-Zeichensatz des Systems und nicht den Zeichensatz des Gebietschemas.</p>
<p><strong>Tn</strong>: Zeitoptionen. Geben Sie für <strong>n</strong> eine der folgenden Zahlen an:<br>
  0: Erzwingt die Verwendung der Standardoptionen. Dies führt dazu, dass Minuten und Sekunden angezeigt werden.<br>
  1: Lässt die Minuten und Sekunden weg.<br>
  2: Lässt die Sekunden weg. <br>
  4: Lässt den Zeitmarker (z. B. AM/PM) weg.<br>
  8: Verwendet das 24-Stunden-Format anstelle des 12-Stunden-Formats.<br>
  12: Hat den kombinierten Effekt von 4 und 8.<br>
  0x80000000: Bewirkt, dass alle Änderungen, die der Benutzer eventuell am Standardzeitformat des Systems durchgeführt hat, ignoriert werden. <br>
  0x40000000: Verwendet zum Übersetzen der Zeichenkettencodierung den ANSI-Zeichensatz des Systems und nicht den Zeichensatz des Gebietschemas.</p>
<p class="note"><strong>Hinweis</strong>: Dn und Tn können beliebig oft verwendet werden, um mehr als eine Option wirksam werden zu lassen, zum Beispiel: <code>FormatTime("20040228 D2 D4 T1 T8")</code></p>
<h3 id="Remarks">Bemerkungen</h3>
<p>Um Buchstaben und Zahlen in <em>Format</em> unverändert nach <em>AusgabeVar</em> zu übertragen, umschließt man sie mit Hochkommas. Zum Beispiel: <code>"'Datum:' MM/dd/yy 'Zeit:' hh:mm:ss tt"</code>.</p>
<p>Nicht-alphanumerische Zeichen wie Leerzeichen, Tabulatoren, LF-Zeichen (`n), Schrägstriche, Doppelpunkte, Kommas und andere Satzzeichen müssen hingegen nicht mit Hochkommas umschlossen werden. Die Ausnahme ist das Hochkomma selbst: Um dieses Zeichen direkt zu schreiben, nutzt man vier aufeinanderfolgende Hochkommas (''''). Wenn das Hochkomma bereits von einem Hochkomma-Paar umschlossen ist, sind nur zwei aufeinanderfolgende Hochkommas ('') notwendig.</p>
<p>Wenn <em>Format</em> sowohl Datums- als auch Zeitelemente enthält, dürfen sie nicht vermischt werden. Das heißt, dass die Elemente so angeordnet werden sollen, dass die resultierende Zeichenkette in zwei Hälften aufgeteilt werden kann: eine Zeithälfte und eine Datumhälfte. Die Formatzeichenkette "hh yyyy mm" beispielsweise würde nicht das erwartete Ergebnis liefern, weil sich ein Datumselement zwischen zwei Zeitelementen befindet.</p>
<p>Enthält <em>Format</em> einen numerischen Monatstag (d oder dd) gefolgt von einem vollständigen Monatsnamen (MMMM), wird der Genitiv des Monatsnamens verwendet (wenn die Sprache einen Genitiv besitzt).</p>
<p>Enthält <em>Format</em> mehr als 2000 Zeichen, wird <em>AusgabeVar</em> leer gemacht.</p>
<p>Mit <a href="DateAdd.htm">DateAdd</a> und <a href="DateDiff.htm">DateDiff</a> können beliebige Datum- und Zeitwerte addiert, subtrahiert und verglichen werden.</p>
<h3>Siehe auch</h3>
<p>Wenn Sie stattdessen den <em><em>umgekehrten</em></em> Weg gehen wollen, eine formatierte Zeichenkette in das <a href="FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a>-Format umzuwandeln, hilft Ihnen der folgende Forumsbeitrag weiter: <a href="http://www.autohotkey.com/forum/topic20405.html">www.autohotkey.com/forum/topic20405.html</a></p>
<p>Siehe auch: <a href="GuiControls.htm#DateTime">DateTime-Steuerelement</a>,<a href="../Variables.htm#date">interne Datums- und Zeitvariablen</a>, <a href="FileGetTime.htm">FileGetTime</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent">ZeitZeichenkette := FormatTime()
MsgBox "Uhrzeit und Datum (Zeit zuerst) ist aktuell " ZeitZeichenkette

ZeitZeichenkette := FormatTime("R")
MsgBox "Uhrzeit und Datum (Datum zuerst) ist aktuell " ZeitZeichenkette

ZeitZeichenkette := FormatTime(, "Time")
MsgBox "Uhrzeit ist aktuell " ZeitZeichenkette

ZeitZeichenkette := FormatTime("T12", "Time")
MsgBox "24-Stunden-Uhrzeit ist aktuell " ZeitZeichenkette

ZeitZeichenkette := FormatTime(, "LongDate")
MsgBox "Datum (Langformat) ist aktuell " ZeitZeichenkette

ZeitZeichenkette := FormatTime(20050423220133, "dddd MMMM d, yyyy hh:mm:ss tt")
MsgBox "Datum und Uhrzeit ist nach dem Formatieren " ZeitZeichenkette

MsgBox FormatTime(200504, "'Monatsname': MMMM`n'Tagesname': dddd")

Jahreswoche := FormatTime(20050101, "YWeek")
MsgBox "Der 1. Januar 2005 hat das folgende Jahr und die Wochennummer nach ISO: " Jahreswoche</pre>

<pre class="NoIndent"><em>; Ändert den Zeitstempel einer Datei:</em>
Dateiname := FileSelect(3,, "Datei auswählen")
if Dateiname = "" <em>; Der Benutzer hat keine Datei ausgewählt.</em>
    return
Dateizeitstempel := FileGetTime(Dateiname)
Dateizeitstempel := FormatTime(Dateizeitstempel)   <em>; Da der letzte Parameter fehlt, gilt das lange Datums- und Zeitformat.</em>
MsgBox "Die ausgewählte Datei wurde zuletzt am " Dateizeitstempel " modifiziert."</pre>

<pre class="NoIndent"><em>; Die folgende Funktion wandelt die angegebene Anzahl an Sekunden in
; Stunden, Minuten und Sekunden um (hh:mm:ss-Format).</em>

MsgBox FormatiereSekunden(7384)  <em>; 7384 = 2 Stunden + 3 Minuten + 4 Sekunden. Rückgabewert: 2:03:04</em>

FormatiereSekunden(AnzahlAnSekunden)  <em>; Wandelt eine Zahl in das hh:mm:ss-Format um.</em>
{
    Zeit := 19990101  <em>; *Mitternacht* eines beliebigen Datums.</em>
    Zeit := DateAdd(Zeit, AnzahlAnSekunden, "Seconds")
    return AnzahlAnSekunden//3600 ":" FormatTime(Zeit, "mm:ss")
    <em>/*
    ; Im Gegensatz zur oberen Methode würde die folgende nicht mehr als 24 Stunden im Wert von Sekunden unterstützen:
    return FormatTime(Zeit, "h:mm:ss")
    */</em>
}</pre>

</body>
</html>
